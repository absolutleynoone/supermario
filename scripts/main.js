"use strict";window.g_aZk=class{constructor(e,g){this.g_aov=e,this.g_aZl=g,this.g_aZm=!1,this.g_anA=()=>this.g_Jj()}g_aZn(){}g_aZo(e,g,a,_){this.g_aov.g_aZp(this.g_aZl,e,g,a,_)}g_aZq(e,g,a,_){return this.g_aov.g_aZr(this.g_aZl,e,g,a,_)}g_aZs(e,g,a){this.g_aov.g_aZt()?this.g_aZo(e,g,a):this.g_aov.g_aZu()._OnMessageFromDOM({type:"event",component:this.g_aZl,handler:e,dispatchOpts:a||null,data:g,responseId:null})}g_aZv(e,g){this.g_aov.g_aZw(this.g_aZl,e,g)}g_aZx(e){for(const[g,a]of e)this.g_aZv(g,a)}g_aZy(){return this.g_aov}g_aZz(){return this.g_aZl}g_abK(){this.g_aZm||(this.g_aov.g_aZA(this.g_anA),this.g_aZm=!0)}g_abv(){this.g_aZm&&(this.g_aov.g_aZB(this.g_anA),this.g_aZm=!1)}g_Jj(){}},"use strict",window.g_aZC=class extends g_aZk{constructor(e,g){super(e,g),this.g_aZD=new Map,this.g_aZE=!0,this.g_aZv("create",e=>this.g_aZF(e)),this.g_aZv("destroy",e=>this.g_aZG(e)),this.g_aZv("set-visible",e=>this.g_aZH(e)),this.g_aZv("update-position",e=>this.g_aZI(e)),this.g_aZv("update-state",e=>this.g_azi(e)),this.g_aZv("focus",e=>this.g_aZJ(e)),this.g_aZv("set-css-style",e=>this.g_aZK(e))}g_aZL(e){this.g_aZE=!!e}g_aZM(e,g){this.g_aZv(e,e=>{const a=e.elementId,_=this.g_aZD.get(a);return g(_,e)})}g_aZF(e){const g=e.elementId,a=this.g_aci(g,e);this.g_aZD.set(g,a),e.isVisible||(a.style.display="none"),this.g_aZE&&document.body.appendChild(a)}g_aci(){throw new Error("required override")}g_aZN(){}g_aZG(e){const g=e.elementId,a=this.g_aZD.get(g);this.g_aZN(a),this.g_aZE&&a.parentElement.removeChild(a),this.g_aZD.delete(g)}g_aZO(e,g,a){a||(a={}),a.elementId=g,this.g_aZo(e,a)}g_aZP(e,g,a){a||(a={}),a.elementId=g,this.g_aZs(e,a)}g_aZH(e){if(this.g_aZE){const g=this.g_aZD.get(e.elementId);g.style.display=e.isVisible?"":"none"}}g_aZI(e){if(this.g_aZE){const g=this.g_aZD.get(e.elementId);g.style.left=e.left+"px",g.style.top=e.top+"px",g.style.width=e.width+"px",g.style.height=e.height+"px";const a=e.fontSize;null!==a&&(g.style.fontSize=a+"em")}}g_azi(e){const g=this.g_aZD.get(e.elementId);this.g_aZQ(g,e)}g_aZQ(){throw new Error("required override")}g_aZJ(e){const g=this.g_aZD.get(e.elementId);e.focus?g.focus():g.blur()}g_aZK(e){const g=this.g_aZD.get(e.elementId);g.style[e.prop]=e.val}g_aZR(e){return this.g_aZD.get(e)}},"use strict";{function _(e){return new Promise((g,a)=>{const _=document.createElement("script");_.onload=g,_.onerror=a,_.async=!1,_.src=e,document.head.appendChild(_)})}async function t(e){const g=await n(e),a=new TextDecoder("utf-8");return a.decode(g)}function n(e){return new Promise((g,_)=>{const a=new FileReader;a.onload=e=>g(e.target.result),a.onerror=e=>_(e),a.readAsArrayBuffer(e)})}const a=/(iphone|ipod|ipad)/i.test(navigator.userAgent);let d=new Audio;const c={"audio/webm; codecs=opus":!!d.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!d.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!d.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!d.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!d.canPlayType("audio/mp4"),"audio/mpeg":!!d.canPlayType("audio/mpeg")};d=null;const e=[];let g=0;window.RealFile=window.File;const o=[],i=new Map,r=new Map;let s=0;const l=[];self.g_aZS=function(e){if("function"!=typeof e)throw new Error("runOnStartup called without a function");l.push(e)},window.g_aZT=class d{constructor(e){this.g_aZU=e.g_aZV,this.g_aZW=null,this.g_amz="",this.g_aZX=e.g_aZY,this.g_aZZ={},this.g_aZ_=null,this.g_aZ$=null,this.g_a_a=[],this.g_a_b=null,this.g_akA=null,this.g_aop=null,this.g_alh=-1,this.g_a_c=()=>this.g_a_d(),this.g_a_e=[],this.g_amE=e.g_a_f,("cordova"===this.g_amE||"playable-ad"===this.g_amE||"instant-games"===this.g_amE)&&this.g_aZU&&(console.warn("[C3 runtime] Worker mode is enabled and supported, but is disabled in WebViews due to crbug.com/923007. Reverting to DOM mode."),this.g_aZU=!1),/CrOS/.test(navigator.userAgent)&&(console.warn("[C3 runtime] Worker mode is enabled and supported, but is disabled in Chrome OS due to reports of crashes. Reverting to DOM mode."),this.g_aZU=!1),this.g_a_g=!1,this.g_a_h=null,("html5"===this.g_amE||"playable-ad"===this.g_amE)&&"file"===location.protocol.substr(0,4)&&alert("Exported games won't work until you upload them. (When running on the file: protocol, browsers block many features from working for security reasons.)"),this.g_aZw("runtime","cordova-fetch-local-file",e=>this.g_a_i(e)),this.g_aZw("runtime","create-job-worker",e=>this.g_a_j(e)),"cordova"===this.g_amE?document.addEventListener("deviceready",()=>this.g_aay(e)):this.g_aay(e)}g_em(){this.g_a_k(),this.g_aZW&&(this.g_aZW.onmessage=null,this.g_aZW=null),this.g_aZ_&&(this.g_aZ_.terminate(),this.g_aZ_=null),this.g_aZ$&&(this.g_aZ$.g_em(),this.g_aZ$=null),this.g_akA&&(this.g_akA.parentElement.removeChild(this.g_akA),this.g_akA=null)}g_a_l(){return this.g_akA}g_fg(){return this.g_amz}g_aZt(){return this.g_aZU}g_apV(){return this.g_amE}g_aoN(){return"cordova"===this.g_amE&&a}g_a_m(){return"cordova"===this.g_amE&&!1===a}async g_aay(e){if("playable-ad"===this.g_amE){this.g_a_h=self.c3_base64files,await this.g_a_n();for(let g=0,a=e.g_a_o.length;g<a;++g){const a=e.g_a_o[g].toLowerCase();this.g_a_h.hasOwnProperty(a)&&(e.g_a_o[g]=URL.createObjectURL(this.g_a_h[a]))}}if(e.g_a_p)this.g_amz=e.g_a_p;else{const e=location.origin;this.g_amz=("null"===e?"file:///":e)+location.pathname;const g=this.g_amz.lastIndexOf("/");-1!==g&&(this.g_amz=this.g_amz.substr(0,g+1))}if(e.g_a_q)for(const[g,a]of Object.entries(e.g_a_q))this.g_aZZ[g]=URL.createObjectURL(a);const g=new MessageChannel;this.g_aZW=g.port1,this.g_aZW.onmessage=e=>this._OnMessageFromRuntime(e.data),window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler(e=>this.g_a_r(e)),this.g_aop=new self.g_a_s(this),await this.g_aop.g_ahH(),this.g_a_t(),"object"==typeof window.StatusBar&&window.StatusBar.hide(),"object"==typeof window.AndroidFullScreen&&window.AndroidFullScreen.immersiveMode(),await this.g_a_u(),this.g_aZU?await this.g_a_v(e,g.port2):await this.g_a_w(e,g.port2)}g_a_x(e){return this.g_aZZ.hasOwnProperty(e)?this.g_aZZ[e]:e.endsWith("/workermain.js")&&this.g_aZZ.hasOwnProperty("workermain.js")?this.g_aZZ["workermain.js"]:"playable-ad"===this.g_amE&&this.g_a_h.hasOwnProperty(e.toLowerCase())?URL.createObjectURL(this.g_a_h[e.toLowerCase()]):e}async g_a_y(g,a,_){if(g.startsWith("blob:"))return new Worker(g,_);if(this.g_aoN()){const e=await this.g_As(this.g_aZX+g),a=new Blob([e],{type:"application/javascript"});return new Worker(URL.createObjectURL(a),_)}const t=new URL(g,a),n=location.origin!==t.origin;if(n){const e=await fetch(t);if(!e.ok)throw new Error("failed to fetch worker script");const g=await e.blob();return new Worker(URL.createObjectURL(g),_)}return new Worker(t,_)}g_a_t(){if(this.g_aoN()){const g=document.documentElement.style,a=document.body.style,_=window.innerWidth<window.innerHeight,t=_?window.screen.width:window.screen.height,n=_?window.screen.height:window.screen.width;a.height=g.height=n+"px",a.width=g.width=t+"px"}}g_a_z(e){return{baseUrl:this.g_amz,windowInnerWidth:window.innerWidth,windowInnerHeight:window.innerHeight,devicePixelRatio:window.devicePixelRatio,isFullscreen:d.g_alL(),projectData:e.g_a_A,previewImageBlobs:window.cr_previewImageBlobs||this.g_a_h,previewProjectFileBlobs:window.cr_previewProjectFileBlobs,exportType:e.g_a_f,isDebug:-1<self.location.search.indexOf("debug"),ife:!!self.g_a_B,jobScheduler:this.g_aop.g_a_C(),supportedAudioFormats:c,opusWasmScriptUrl:window.cr_opusWasmScriptUrl||this.g_aZX+"opus.wasm.js",opusWasmBinaryUrl:window.cr_opusWasmBinaryUrl||this.g_aZX+"opus.wasm.wasm",isWKWebView:this.g_aoN(),isFBInstantAvailable:"undefined"!=typeof self.FBInstant}}async g_a_v(e,g){const a=this.g_a_x(e.g_a_D);this.g_aZ_=await this.g_a_y(a,this.g_amz,{name:"Runtime"}),this.g_akA=document.createElement("canvas"),this.g_akA.style.display="none";const _=this.g_akA.transferControlToOffscreen();document.body.appendChild(this.g_akA),window.c3canvas=this.g_akA,this.g_aZ_.postMessage(Object.assign(this.g_a_z(e),{type:"init-runtime",isInWorker:!0,messagePort:g,canvas:_,workerDependencyScripts:e.g_a_E||[],engineScripts:e.g_a_o,projectScripts:window.g_a_F,projectScriptsStatus:self.C3_ProjectScriptsStatus}),[g,_,...this.g_aop.g_a_G()]),this.g_a_a=o.map(e=>new e(this)),this.g_a_H(),self.c3_callFunction=(e,g)=>this.g_a_b.g_S$(e,g),"preview"===this.g_amE&&(self.goToLastErrorScript=()=>this.g_aZp("runtime","go-to-last-error-script"))}async g_a_w(g,a){this.g_akA=document.createElement("canvas"),this.g_akA.style.display="none",document.body.appendChild(this.g_akA),window.c3canvas=this.g_akA,this.g_a_a=o.map(e=>new e(this)),this.g_a_H();const t=g.g_a_o.map(e=>new URL(e,this.g_amz).toString());if(Array.isArray(g.g_a_E)&&t.unshift(...g.g_a_E),await Promise.all(t.map(e=>_(e))),g.g_a_I&&0<g.g_a_I.length){const e=self.C3_ProjectScriptsStatus;try{if(await Promise.all(g.g_a_I.map(e=>_(e[1]))),Object.values(e).some(e=>!e))return void self.setTimeout(()=>this.g_a_J(e),100)}catch(g){return console.error("[Preview] Error loading project scripts: ",g),void self.setTimeout(()=>this.g_a_J(e),100)}}if("preview"===this.g_amE&&"object"!=typeof self.g_aQ.g_aZj)return console.error("[C3 runtime] Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax."),void alert("Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax.");const n=Object.assign(this.g_a_z(g),{isInWorker:!1,messagePort:a,canvas:this.g_akA,runOnStartupFunctions:l});this.g_aZ$=self.C3_CreateRuntime(n),await self.C3_InitRuntime(this.g_aZ$,n)}g_a_J(e){const g=Object.entries(e).filter(e=>!e[1]).map(e=>e[0]),a=`Failed to load project script '${g[0]}'. Check all your JavaScript code has valid syntax.`;console.error("[Preview] "+a),alert(a)}async g_a_j(){const e=await this.g_aop.g_a_K();return{outputPort:e,transferables:[e]}}g_aZu(){if(this.g_aZU)throw new Error("not available in worker mode");return this.g_aZ$}g_aZp(g,a,_,t,n){this.g_aZW.postMessage({type:"event",component:g,handler:a,dispatchOpts:t||null,data:_,responseId:null},this.g_a_g?void 0:n)}g_aZr(_,a,t,n,d){const e=s++,i=new Promise((g,a)=>{r.set(e,{resolve:g,reject:a})});return this.g_aZW.postMessage({type:"event",component:_,handler:a,dispatchOpts:n||null,data:t,responseId:e},this.g_a_g?void 0:d),i}["_OnMessageFromRuntime"](e){const g=e.type;if("event"===g)this.g_a_L(e);else if("result"===g)this.g_a_M(e);else if("runtime-ready"===g)this.g_a_N();else if("alert"===g)alert(e.message);else throw new Error(`unknown message '${g}'`)}g_a_L(_){const t=_.component,n=_.handler,a=_.data,d=_.responseId,e=i.get(t);if(!e)return void console.warn(`[DOM] No event handlers for component '${t}'`);const c=e.get(n);if(!c)return void console.warn(`[DOM] No handler '${n}' for component '${t}'`);let g=null;try{g=c(a)}catch(e){return console.error(`Exception in '${t}' handler '${n}':`,e),void(null!==d&&this.g_a_O(d,!1,e.toString()))}null!==d&&(g&&g.then?g.then(e=>this.g_a_O(d,!0,e)).catch(e=>{console.error(`Rejection from '${t}' handler '${n}':`,e),this.g_a_O(d,!1,e.toString())}):this.g_a_O(d,!0,g))}g_a_O(e,g,a){let _;a&&a.transferables&&(_=a.transferables),this.g_aZW.postMessage({type:"result",responseId:e,isOk:g,result:a},_)}g_a_M(g){const a=g.responseId,_=g.isOk,t=g.result,n=r.get(a);_?n.resolve(t):n.reject(t),r.delete(a)}g_aZw(e,g,a){let _=i.get(e);if(_||(_=new Map,i.set(e,_)),_.has(g))throw new Error(`[DOM] Component '${e}' already has handler '${g}'`);_.set(g,a)}static g_a_P(e){if(o.includes(e))throw new Error("DOM handler already added");o.push(e)}g_a_H(){for(const e of this.g_a_a)if("runtime"===e.g_aZz())return void(this.g_a_b=e);throw new Error("cannot find runtime DOM handler")}g_a_r(e){this.g_aZp("debugger","message",e)}g_a_N(){for(const e of this.g_a_a)e.g_aZn()}static g_alL(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)}async g_a_Q(){return await this.g_aZr("runtime","get-remote-preview-status-info")}g_aZA(e){this.g_a_e.push(e),this.g_a_R()}g_aZB(e){const g=this.g_a_e.indexOf(e);if(-1===g)throw new Error("invalid callback");this.g_a_e.splice(g,1),this.g_a_e.length||this.g_a_k()}g_a_R(){-1===this.g_alh&&this.g_a_e.length&&(this.g_alh=requestAnimationFrame(this.g_a_c))}g_a_k(){-1!==this.g_alh&&(cancelAnimationFrame(this.g_alh),this.g_alh=-1)}g_a_d(){this.g_alh=-1;for(const e of this.g_a_e)e();this.g_a_R()}g_a_S(e){this.g_a_b.g_a_S(e)}g_a_T(e){this.g_a_b.g_a_T(e)}g_a_U(){this.g_a_b.g_a_U()}g_azU(e){this.g_a_b.g_azU(e)}g_AP(e){return!!c[e]}async g_adC(e){const g=await this.g_aZr("runtime","opus-decode",{arrayBuffer:e},null,[e]);return new Float32Array(g)}g_fS(e){return /^(?:[a-z]+:)?\/\//.test(e)||"data:"===e.substr(0,5)||"blob:"===e.substr(0,5)}g_fT(e){return!this.g_fS(e)}async g_a_i(e){const g=e.filename;switch(e.as){case"text":return await this.g_At(g);case"buffer":return await this.g_As(g);default:throw new Error("unsupported type");}}g_a_V(e){const g=window.cordova.file.applicationDirectory+"www/"+e.toLowerCase();return new Promise((e,a)=>{window.resolveLocalFileSystemURL(g,g=>{g.file(e,a)},a)})}async g_At(e){const g=await this.g_a_V(e);return await t(g)}g_a_W(){if(e.length&&!(8<=g)){g++;const _=e.shift();this.g_a_X(_.filename,_.g_a_Y,_.g_a_Z)}}g_As(_){return new Promise((t,n)=>{e.push({filename:_,g_a_Y:e=>{g--,this.g_a_W(),t(e)},g_a_Z:e=>{g--,this.g_a_W(),n(e)}}),this.g_a_W()})}async g_a_X(g,a,e){try{const _=await this.g_a_V(g),t=await n(_);a(t)}catch(g){e(g)}}async g_a_n(){const e=[];for(const[g,a]of Object.entries(this.g_a_h))e.push(this.g_a__(g,a));await Promise.all(e)}async g_a__(e,g){if("object"==typeof g)this.g_a_h[e]=new Blob([g.str],{type:g.type});else{const a=await fetch(g),_=await a.blob();this.g_a_h[e]=_}}g_a_u(){let e=null;const g=new Promise(g=>e=g),_=new ArrayBuffer(1),t=new MessageChannel;return t.port2.onmessage=g=>{g.data&&g.data.arrayBuffer||(this.g_a_g=!0,console.warn("MessageChannel transfers determined to be broken. Disabling transferables.")),e()},t.port1.postMessage({arrayBuffer:_},[_]),g}}}{function _(e){return e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents||e.originalEvent&&e.originalEvent.sourceCapabilities&&e.originalEvent.sourceCapabilities.firesTouchEvents}function t(e){return new Promise((g,_)=>{const a=document.createElement("link");a.onload=()=>g(a),a.onerror=e=>_(e),a.rel="stylesheet",a.href=e,document.head.appendChild(a)})}function a(e){return new Promise((g,_)=>{const a=new Image;a.onload=()=>g(a),a.onerror=e=>_(e),a.src=e})}async function r(e){const g=URL.createObjectURL(e);try{return await a(g)}finally{URL.revokeObjectURL(g)}}function s(e){do{if(e.parentNode&&e.hasAttribute("contenteditable"))return!0;e=e.parentNode}while(e);return!1}function d(e){const g=e.target.tagName.toLowerCase();l.has(g)&&e.preventDefault()}function e(e){(e.metaKey||e.ctrlKey)&&e.preventDefault()}function g(){try{return window.parent&&window.parent.document.hasFocus()}catch(e){return!1}}const u=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),i={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},p={dispatchUserScriptEvent:!0},c={dispatchRuntimeEvent:!0},l=new Set(["canvas","body","html"]);self.C3_RasterSvgImage=async function(g,a,_){const t=document.createElement("canvas");t.width=a,t.height=_;const n=t.getContext("2d");return n.drawImage(g,0,0,a,_),t};let b=!1;document.addEventListener("pause",()=>b=!0),document.addEventListener("resume",()=>b=!1);const n=class extends g_aZk{constructor(g){super(g,"runtime"),this.g_a_$=!0,this.g_a$a=-1,this.g_a$b="any",this.g_a$c=!1,this.g_a$d=!1,this.g_a$e=null,g.g_aZw("canvas","update-size",e=>this.g_a$f(e)),g.g_aZw("runtime","invoke-download",e=>this.g_a$g(e)),g.g_aZw("runtime","raster-svg-image",e=>this.g_a$h(e)),g.g_aZw("runtime","set-target-orientation",e=>this.g_a$i(e)),g.g_aZw("runtime","register-sw",()=>this.g_a$j()),g.g_aZw("runtime","post-to-debugger",e=>this.g_a$k(e)),g.g_aZw("runtime","go-to-script",e=>this.g_a$k(e)),g.g_aZw("runtime","before-start-ticking",()=>this.g_a$l()),g.g_aZw("runtime","debug-highlight",e=>this.g_a$m(e)),g.g_aZw("runtime","enable-device-orientation",()=>this.g_a$n()),g.g_aZw("runtime","enable-device-motion",()=>this.g_a$o()),g.g_aZw("runtime","add-stylesheet",e=>this.g_a$p(e));const _=new Set(["input","textarea","datalist"]);window.addEventListener("contextmenu",e=>{const g=e.target,a=g.tagName.toLowerCase();_.has(a)||s(g)||e.preventDefault()}),window.addEventListener("selectstart",d),window.addEventListener("gesturehold",d),window.addEventListener("touchstart",d,{passive:!1});const a=g.g_a_l();"undefined"==typeof PointerEvent?a.addEventListener("touchstart",d):(window.addEventListener("pointerdown",d,{passive:!1}),a.addEventListener("pointerdown",d)),this.g_a$q=0,window.addEventListener("mousedown",e=>{1===e.button&&e.preventDefault()}),window.addEventListener("mousewheel",e,{passive:!1}),window.addEventListener("wheel",e,{passive:!1}),window.addEventListener("resize",()=>this.g_aly()),this.g_a$r=new Set,this.g_a$s=new WeakSet,this.g_aza=!1}g_a$l(){return"cordova"===this.g_aov.g_apV()?(document.addEventListener("pause",()=>this.g_aor(!0)),document.addEventListener("resume",()=>this.g_aor(!1))):document.addEventListener("visibilitychange",()=>this.g_aor(document.hidden)),{isSuspended:!!(document.hidden||b)}}g_aZn(){window.addEventListener("focus",()=>this.g_a$t("window-focus")),window.addEventListener("blur",()=>{this.g_a$t("window-blur",{parentHasFocus:g()}),this.g_a$q=0}),window.addEventListener("fullscreenchange",()=>this.g_alz()),window.addEventListener("webkitfullscreenchange",()=>this.g_alz()),window.addEventListener("mozfullscreenchange",()=>this.g_alz()),window.addEventListener("fullscreenerror",e=>this.g_alA(e)),window.addEventListener("webkitfullscreenerror",e=>this.g_alA(e)),window.addEventListener("mozfullscreenerror",e=>this.g_alA(e)),window.addEventListener("keydown",e=>this.g_a$u("keydown",e)),window.addEventListener("keyup",e=>this.g_a$u("keyup",e)),window.addEventListener("dblclick",e=>this.g_a$v("dblclick",e,i)),window.addEventListener("wheel",e=>this.g_a$w("wheel",e)),"undefined"==typeof PointerEvent?(window.addEventListener("mousedown",e=>this.g_a$x("pointerdown",e)),window.addEventListener("mousemove",e=>this.g_a$x("pointermove",e)),window.addEventListener("mouseup",e=>this.g_a$x("pointerup",e)),window.addEventListener("touchstart",e=>this.g_a$y("pointerdown",e)),window.addEventListener("touchmove",e=>this.g_a$y("pointermove",e)),window.addEventListener("touchend",e=>this.g_a$y("pointerup",e)),window.addEventListener("touchcancel",e=>this.g_a$y("pointercancel",e))):(window.addEventListener("pointerdown",e=>this.g_a$z("pointerdown",e)),window.addEventListener("pointermove",e=>this.g_a$z("pointermove",e)),window.addEventListener("pointerup",e=>this.g_a$z("pointerup",e)),window.addEventListener("pointercancel",e=>this.g_a$z("pointercancel",e)));const e=()=>this.g_a_U();window.addEventListener("pointerup",e,!0),window.addEventListener("touchend",e,!0),window.addEventListener("click",e,!0),window.addEventListener("keydown",e,!0),window.addEventListener("gamepadconnected",e,!0)}g_a$t(e,g){this.g_aZo(e,g||null,c)}g_a$A(){return Math.max(window.innerWidth,1)}g_a$B(){return Math.max(window.innerHeight,1)}g_aly(){const e=this.g_a$A(),g=this.g_a$B();this.g_a$t("window-resize",{innerWidth:e,innerHeight:g,devicePixelRatio:window.devicePixelRatio}),this.g_aov.g_aoN()&&(-1!==this.g_a$a&&clearTimeout(this.g_a$a),this.g_a$C(e,g,0))}g_a$D(e,g,a){-1!==this.g_a$a&&clearTimeout(this.g_a$a),this.g_a$a=setTimeout(()=>this.g_a$C(e,g,a),48)}g_a$C(g,a,_){const t=this.g_a$A(),n=this.g_a$B();this.g_a$a=-1,t!=g||n!=a?this.g_a$t("window-resize",{innerWidth:t,innerHeight:n,devicePixelRatio:window.devicePixelRatio}):10>_&&this.g_a$D(t,n,_+1)}g_a$i(e){this.g_a$b=e.targetOrientation}g_a$E(){const e=this.g_a$b;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(e).catch(e=>console.warn("[Construct 3] Failed to lock orientation: ",e));else try{let g=!1;screen.lockOrientation?g=screen.lockOrientation(e):screen.webkitLockOrientation?g=screen.webkitLockOrientation(e):screen.mozLockOrientation?g=screen.mozLockOrientation(e):screen.msLockOrientation&&(g=screen.msLockOrientation(e)),g||console.warn("[Construct 3] Failed to lock orientation")}catch(e){console.warn("[Construct 3] Failed to lock orientation: ",e)}}g_alz(){const e=g_aZT.g_alL();e&&"any"!==this.g_a$b&&this.g_a$E(),this.g_aZo("fullscreenchange",{isFullscreen:e,innerWidth:this.g_a$A(),innerHeight:this.g_a$B()})}g_alA(e){console.warn("[Construct 3] Fullscreen request failed: ",e),this.g_aZo("fullscreenerror",{isFullscreen:g_aZT.g_alL(),innerWidth:this.g_a$A(),innerHeight:this.g_a$B()})}g_aor(e){e?this.g_aov.g_a_k():this.g_aov.g_a_R(),this.g_aZo("visibilitychange",{hidden:e})}g_a$u(e,g){const a=u.get(g.code)||g.code;this.g_aZs(e,{code:a,key:g.key,which:g.which,repeat:g.repeat,altKey:g.altKey,ctrlKey:g.ctrlKey,metaKey:g.metaKey,shiftKey:g.shiftKey,timeStamp:g.timeStamp},i)}g_a$w(e,g){this.g_aZo(e,{clientX:g.clientX,clientY:g.clientY,deltaX:g.deltaX,deltaY:g.deltaY,deltaZ:g.deltaZ,deltaMode:g.deltaMode,timeStamp:g.timeStamp},i)}g_a$v(e,g,a){_(g)||("mousedown"===e&&window!==window.top&&window.focus(),this.g_aZs(e,{button:g.button,buttons:g.buttons,clientX:g.clientX,clientY:g.clientY,timeStamp:g.timeStamp},a))}g_a$x(e,g){if(!_(g)){"pointerdown"===e&&window!==window.top&&window.focus();const a=this.g_a$q;"pointerdown"===e&&0!==a?e="pointermove":"pointerup"==e&&0!==g.buttons&&(e="pointermove"),this.g_aZs(e,{pointerId:1,pointerType:"mouse",button:g.button,buttons:g.buttons,lastButtons:a,clientX:g.clientX,clientY:g.clientY,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,timeStamp:g.timeStamp},i),this.g_a$q=g.buttons,this.g_a$v(g.type,g,p)}}g_a$z(e,g){"pointerdown"===e&&window!==window.top&&window.focus();let a=0;if("mouse"===g.pointerType&&(a=this.g_a$q),this.g_aZs(e,{pointerId:g.pointerId,pointerType:g.pointerType,button:g.button,buttons:g.buttons,lastButtons:a,clientX:g.clientX,clientY:g.clientY,width:g.width||0,height:g.height||0,pressure:g.pressure||0,tangentialPressure:g.tangentialPressure||0,tiltX:g.tiltX||0,tiltY:g.tiltY||0,twist:g.twist||0,timeStamp:g.timeStamp},i),"mouse"===g.pointerType){let a="mousemove";"pointerdown"===e?a="mousedown":"pointerup"==e&&(a="pointerup"),this.g_a$v(a,g,p),this.g_a$q=g.buttons}}g_a$y(e,g){"pointerdown"===e&&window!==window.top&&window.focus();for(let a=0,_=g.changedTouches.length;a<_;++a){const _=g.changedTouches[a];this.g_aZs(e,{pointerId:_.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:_.clientX,clientY:_.clientY,width:2*(_.radiusX||_.webkitRadiusX||0),height:2*(_.radiusY||_.webkitRadiusY||0),pressure:_.force||_.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:_.rotationAngle||0,timeStamp:g.timeStamp},i)}}g_a$n(){this.g_a$c||(this.g_a$c=!0,window.addEventListener("deviceorientation",e=>this.g_a$F(e)))}g_a$o(){this.g_a$d||(this.g_a$d=!0,window.addEventListener("devicemotion",e=>this.g_a$G(e)))}g_a$F(e){this.g_aZo("deviceorientation",{alpha:e.alpha||0,beta:e.beta||0,gamma:e.gamma||0,timeStamp:e.timeStamp},i)}g_a$G(_){let a=null;const t=_.acceleration;t&&(a={x:t.x||0,y:t.y||0,z:t.z||0});let n=null;const c=_.accelerationIncludingGravity;c&&(n={x:c.x||0,y:c.y||0,z:c.z||0});let e=null;const o=_.rotationRate;o&&(e={alpha:o.alpha||0,beta:o.beta||0,gamma:o.gamma||0}),this.g_aZo("devicemotion",{acceleration:a,accelerationIncludingGravity:n,rotationRate:e,interval:_.interval,timeStamp:_.timeStamp},i)}g_a$f(e){const g=this.g_aZy(),a=g.g_a_l();a.style.width=e.styleWidth+"px",a.style.height=e.styleHeight+"px",a.style.marginLeft=e.marginLeft+"px",a.style.marginTop=e.marginTop+"px",g.g_a_t(),this.g_a_$&&(a.style.display="",this.g_a_$=!1)}g_a$g(g){const _=g.url,t=g.filename,n=document.createElement("a"),e=document.body;n.textContent=t,n.href=_,n.download=t,e.appendChild(n),n.click(),e.removeChild(n)}async g_a$h(_){const a=_.blob,t=_.width,n=_.height,e=await r(a),d=await self.C3_RasterSvgImage(e,t,n);return await createImageBitmap(d)}async g_a$p(e){await t(e.url)}g_a_U(){const e=[...this.g_a$r];if(this.g_a$r.clear(),!this.g_aza)for(const g of e){const e=g.play();e&&e.catch(()=>{this.g_a$s.has(g)||this.g_a$r.add(g)})}}g_a_S(e){if("function"!=typeof e.play)throw new Error("missing play function");this.g_a$s.delete(e);let g;try{g=e.play()}catch(g){return void this.g_a$r.add(e)}g&&g.catch(()=>{this.g_a$s.has(e)||this.g_a$r.add(e)})}g_a_T(e){this.g_a$r.delete(e),this.g_a$s.add(e)}g_azU(e){this.g_aza=!!e}g_a$m(e){const g=e.show;if(!g)return void(this.g_a$e&&(this.g_a$e.style.display="none"));this.g_a$e||(this.g_a$e=document.createElement("div"),this.g_a$e.id="inspectOutline",document.body.appendChild(this.g_a$e));const a=this.g_a$e;a.style.display="",a.style.left=e.left-1+"px",a.style.top=e.top-1+"px",a.style.width=e.width+2+"px",a.style.height=e.height+2+"px",a.textContent=e.name}g_a$j(){window.C3_RegisterSW&&window.C3_RegisterSW()}g_a$k(e){window.c3_postToMessagePort&&(e.from="runtime",window.c3_postToMessagePort(e))}g_S$(e,g){return this.g_aZq("js-invoke-function",{name:e,params:g})}};g_aZT.g_a_P(n)}{const e=document.currentScript.src;self.g_a_s=class{constructor(g){this.g_a$H=g,this.g_amz=e?e.substr(0,e.lastIndexOf("/")+1):g.g_fg(),this.g_aqA=Math.min(navigator.hardwareConcurrency||2,16),this.g_a$I=null,this.g_a$J=[],this.g_aqy=null,this.g_a$K=null}async g_ahH(){if(this.g_a$L)throw new Error("already initialised");this.g_a$L=!0;const e=this.g_a$H.g_a_x("dispatchworker.js");this.g_a$I=await this.g_a$H.g_a_y(e,this.g_amz,{name:"DispatchWorker"});const g=new MessageChannel;this.g_aqy=g.port1,this.g_a$I.postMessage({type:"_init","in-port":g.port2},[g.port2]),this.g_a$K=await this.g_a_K()}async g_a_K(){const g=this.g_a$J.length,a=this.g_a$H.g_a_x("jobworker.js"),_=await this.g_a$H.g_a_y(a,this.g_amz,{name:"JobWorker"+g}),t=new MessageChannel,n=new MessageChannel;return this.g_a$I.postMessage({type:"_addJobWorker",port:t.port1},[t.port1]),_.postMessage({type:"init",number:g,"dispatch-port":t.port2,"output-port":n.port2},[t.port2,n.port2]),this.g_a$J.push(_),n.port1}g_a_C(){return{inputPort:this.g_aqy,outputPort:this.g_a$K,maxNumWorkers:this.g_aqA}}g_a_G(){return[this.g_aqy,this.g_a$K]}}}if("use strict",window.C3_IsSupported){"undefined"!=typeof OffscreenCanvas;window.c3_runtimeInterface=new g_aZT({g_aZV:!1,g_a_D:"workermain.js",g_a_o:["scripts/c3runtime.js"],g_aZY:"scripts/",g_a_E:[],g_a_f:"html5"})}{const e=class extends g_aZk{constructor(e){super(e,"mouse"),this.g_aZv("cursor",e=>this.g_a$M(e))}g_a$M(e){document.body.style.cursor=e}};g_aZT.g_a_P(e)}{const e=class extends g_aZk{constructor(e){super(e,"browser"),this.g_amE="",this.g_aZv("get-initial-state",e=>this.g_a$N(e)),this.g_aZv("ready-for-sw-messages",()=>this.g_a$O()),this.g_aZv("alert",e=>this.g_a$P(e)),this.g_aZv("close",()=>this.g_a$Q()),this.g_aZv("set-focus",e=>this.g_aZJ(e)),this.g_aZv("vibrate",e=>this.g_a$R(e)),this.g_aZv("lock-orientation",e=>this.g_a$S(e)),this.g_aZv("unlock-orientation",()=>this.g_a$T()),this.g_aZv("navigate",e=>this.g_a$U(e)),this.g_aZv("request-fullscreen",e=>this.g_a$V(e)),this.g_aZv("exit-fullscreen",()=>this.g_a$W()),window.addEventListener("online",()=>this.g_axt(!0)),window.addEventListener("offline",()=>this.g_axt(!1)),document.addEventListener("backbutton",()=>this.g_a$X()),"undefined"!=typeof Windows&&Windows.UI.Core.SystemNavigationManager.getForCurrentView().addEventListener("backrequested",e=>this.g_a$Y(e))}g_a$N(e){return this.g_amE=e.exportType,{location:location.toString(),isOnline:!!navigator.onLine,referrer:document.referrer,title:document.title,isCookieEnabled:!!navigator.cookieEnabled,screenWidth:screen.width,screenHeight:screen.height,windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,isScirraArcade:"undefined"!=typeof window.is_scirra_arcade}}g_a$O(){window.C3_RegisterSW&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(e=>this.g_aZo("sw-message",e.data))}g_axt(e){this.g_aZo("online-state",{isOnline:e})}g_a$X(){this.g_aZo("backbutton")}g_a$Y(e){e.handled=!0,this.g_aZo("backbutton")}g_a$Z(){return"nwjs"===this.g_amE?nw.Window.get():null}g_a$P(e){alert(e.message)}g_a$Q(){navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():window.close()}g_aZJ(e){const g=e.isFocus;if("nwjs"===this.g_amE){const e=this.g_a$Z();g?e.focus():e.blur()}else g?window.focus():window.blur()}g_a$R(e){navigator.vibrate&&navigator.vibrate(e.pattern)}g_a$S(e){const g=e.orientation;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(g).catch(e=>console.warn("[Construct 3] Failed to lock orientation: ",e));else try{let e=!1;screen.lockOrientation?e=screen.lockOrientation(g):screen.webkitLockOrientation?e=screen.webkitLockOrientation(g):screen.mozLockOrientation?e=screen.mozLockOrientation(g):screen.msLockOrientation&&(e=screen.msLockOrientation(g)),e||console.warn("[Construct 3] Failed to lock orientation")}catch(e){console.warn("[Construct 3] Failed to lock orientation: ",e)}}g_a$T(){try{screen.orientation&&screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()}catch(e){}}g_a$U(e){const g=e.type;if("back"===g)navigator.app&&navigator.app.backHistory?navigator.app.backHistory():window.back();else if("forward"===g)window.forward();else if("home"===g)window.g_a$_();else if("reload"===g)location.reload();else if("url"===g){const g=e.url,a=e.target,_=e.exportType;"windows-uwp"===_&&"undefined"!=typeof Windows?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(g)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(g,{openExternal:!0}):"cordova"===_?window.open(g,"_system"):"preview"===_?window.open(g,"_blank"):!this.g_axs&&(2===a?window.top.location=g:1===a?window.parent.location=g:window.location=g)}else if("new-window"===g){const g=e.url,a=e.tag,_=e.exportType;"windows-uwp"===_&&"undefined"!=typeof Windows?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(g)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(g,{openExternal:!0}):"cordova"===_?window.open(g,"_system"):window.open(g,a)}}g_a$V(e){const g={navigationUI:"auto"},a=e.navUI;1===a?g.navigationUI="hide":2===a&&(g.navigationUI="show");const _=document.documentElement;_.requestFullscreen?_.requestFullscreen(g):_.mozRequestFullScreen?_.mozRequestFullScreen(g):_.msRequestFullscreen?_.msRequestFullscreen(g):_.webkitRequestFullScreen&&("undefined"==typeof Element.ALLOW_KEYBOARD_INPUT?_.webkitRequestFullScreen():_.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT))}g_a$W(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()}};g_aZT.g_a_P(e)}{function e(e,g){return e.length===g.length&&(e===g||e.toLowerCase()===g.toLowerCase())}const g=class extends g_aZk{constructor(e){super(e,"audio"),this.g_a$$=null,this.g_baa=null,this.g_bab=!1,this.g_bac=()=>this.g_bad(),this.g_bae=[],this.g_baf=[],this.g_bag=null,this.g_bah="",this.g_bai=-1,this.g_baj=new Map,this.g_ay$=1,this.g_aza=!1,this.g_ayO=0,this.g_ahD=1,this.g_anQ=0,this.g_ayR="HRTF",this.g_ayS="inverse",this.g_bak=600,this.g_ayX=1e4,this.g_ayY=1,this.g_bal=!1,this.g_bam=!1,this.g_ban=this.g_aov.g_AP("audio/webm; codecs=opus"),this.g_bao=new Map,this.g_bap=new Set,this.g_baq=!1,this.g_bar="",this.g_bas=null,self.C3Audio_OnMicrophoneStream=(e,g)=>this.g_bat(e,g),this.g_bau=null,self.C3Audio_GetOutputStream=()=>this.g_bav(),this.g_aZx([["create-audio-context",e=>this.g_baw(e)],["play",e=>this.g_bax(e)],["stop",e=>this.g_aLp(e)],["stop-all",()=>this.g_bay()],["set-paused",e=>this.g_baz(e)],["set-volume",e=>this.g_baA(e)],["fade-volume",e=>this.g_baB(e)],["set-master-volume",e=>this.g_baC(e)],["set-muted",e=>this.g_baD(e)],["set-silent",e=>this.g_baE(e)],["set-looping",e=>this.g_baF(e)],["set-playback-rate",e=>this.g_baG(e)],["seek",e=>this.g_baH(e)],["preload",e=>this.g_baI(e)],["unload",e=>this.g_F_(e)],["unload-all",()=>this.g_baJ()],["set-suspended",e=>this.g_baK(e)],["add-effect",e=>this.g_baL(e)],["set-effect-param",e=>this.g_baM(e)],["remove-effects",e=>this.g_baN(e)],["tick",e=>this.g_Ip(e)],["load-state",e=>this.g_baO(e)]])}async g_baw(e){e.isWKWebView&&(this.g_bal=!0),this.g_ayO=e.timeScaleMode,this.g_ayR=["equalpower","HRTF","soundfield"][e.panningModel],this.g_ayS=["linear","inverse","exponential"][e.distanceModel],this.g_bak=e.refDistance,this.g_ayX=e.maxDistance,this.g_ayY=e.rolloffFactor;const g={latencyHint:e.latencyHint};if("undefined"!=typeof AudioContext)this.g_a$$=new AudioContext(g);else if("undefined"!=typeof webkitAudioContext)this.g_a$$=new webkitAudioContext(g);else throw new Error("Web Audio API not supported");this.g_baa=this.g_a$$.createGain(),this.g_baa.connect(this.g_a$$.destination);const a=e.listenerPos;this.g_a$$.listener.setPosition(a[0],a[1],a[2]),this.g_a$$.listener.setOrientation(0,0,1,0,-1,0),window.addEventListener("pointerup",this.g_bac,!0),window.addEventListener("touchend",this.g_bac,!0),window.addEventListener("click",this.g_bac,!0),window.addEventListener("keydown",this.g_bac,!0),self.C3_GetAudioContextCurrentTime=()=>this.g_baP();try{await Promise.all(e.preloadList.map(e=>this.g_baQ(e.originalUrl,e.url,e.type,!1)))}catch(e){console.error("[Construct 3] Preloading sounds failed: ",e)}return{sampleRate:this.g_a$$.sampleRate}}g_bad(){if(!this.g_bab){const e=this.g_a$$;"suspended"===e.state&&e.resume&&e.resume();const g=e.createBuffer(1,220,22050),a=e.createBufferSource();a.buffer=g,a.connect(e.destination),a.start(0),"running"===e.state&&(this.g_bab=!0,window.removeEventListener("pointerup",this.g_bac,!0),window.removeEventListener("touchend",this.g_bac,!0),window.removeEventListener("click",this.g_bac,!0),window.removeEventListener("keydown",this.g_bac,!0),this.g_bac=null)}}g_baR(){return this.g_a$$}g_baP(){return this.g_a$$.currentTime}g_baS(){return this.g_baa}g_baT(e){const g=this.g_bao.get(e.toLowerCase());return g?g[0].g_baU():this.g_baS()}g_baV(e,g){e=e.toLowerCase();let _=this.g_bao.get(e);_||(_=[],this.g_bao.set(e,_)),g.g_ajk(_.length),g.g_baW(e),_.push(g),this.g_baX(e)}g_baX(e){let g=this.g_baS();const _=this.g_bao.get(e);if(_&&_.length){g=_[0].g_baU();for(let e=0,g=_.length;e<g;++e){const a=_[e];e+1===g?a.g_baY(this.g_baS()):a.g_baY(_[e+1].g_baU())}}for(const a of this.g_baZ(e))a.g_ba_(g);this.g_bas&&this.g_bar===e&&(this.g_bas.disconnect(),this.g_bas.connect(g))}g_ba$(){return this.g_ay$}g_azD(){return this.g_aza}g_bba(){return this.g_ayO}g_Jh(){return this.g_ahD}g_EK(){return this.g_anQ}g_bbb(){return this.g_bal}g_bbc(){return this.g_ban}g_bbd(){this.g_bam=!0}g_bbe(){return this.g_ayR}g_bbf(){return this.g_ayS}g_bbg(){return this.g_bak}g_bbh(){return this.g_ayX}g_bbi(){return this.g_ayY}g_bbj(e,g){return g?this.g_aov.g_adC(e).then(e=>{const g=this.g_a$$.createBuffer(1,e.length,48e3),a=g.getChannelData(0);return a.set(e),g}):new Promise((g,a)=>{this.g_a$$.decodeAudioData(e,g,a)})}g_a_S(e){this.g_aov.g_a_S(e)}g_a_T(e){this.g_aov.g_a_T(e)}g_bbk(g){let a=0;for(let _=0,e=this.g_baf.length;_<e;++_){const t=this.g_baf[_];this.g_baf[a]=t,t.g_bbl()===g?t.g_em():++a}this.g_baf.length=a}g_bbm(){let e=0;for(let g=0,a=this.g_bae.length;g<a;++g){const a=this.g_bae[g];this.g_bae[e]=a,a.g_bbn()?a.g_em():++e}this.g_bae.length=e}*g_baZ(g){if(g)for(const a of this.g_baf)e(a.g_bbo(),g)&&(yield a);else this.g_bag&&!this.g_bag.g_aA$()&&(yield this.g_bag)}async g_baQ(g,a,_,t,n){for(const e of this.g_bae)if(e.g_bbp()===a)return await e.g_AE(),e;if(n)return null;t&&(this.g_bal||this.g_bam)&&this.g_bbm();const e=g_bbq.g_pB(this,g,a,_,t);return this.g_bae.push(e),await e.g_AE(),e}async g_bbr(_,a,t,n,d){for(const e of this.g_baf)if(e.g_bbp()===a&&(e.g_bbs()||d))return e.g_bbt(n),e;const e=await this.g_baQ(_,a,t,d),i=e.g_adR(n);return this.g_baf.push(i),i}g_bbu(e){let g=this.g_baj.get(e);if(!g){let _=null;const a=new Promise(e=>_=e);g={g_bbv:0,promise:a,resolve:_},this.g_baj.set(e,g)}g.g_bbv++}g_bbw(e){const g=this.g_baj.get(e);if(!g)throw new Error("expected pending tag");g.g_bbv--,0===g.g_bbv&&(g.resolve(),this.g_baj.delete(e))}g_bbx(e){e||(e=this.g_bah);const g=this.g_baj.get(e);return g?g.promise:Promise.resolve()}g_bby(){if(0<this.g_bap.size)return void this.g_abK();for(const e of this.g_baf)if(e.g_VM())return void this.g_abK()}g_Jj(){for(const e of this.g_bap)e.g_Jj();const e=this.g_baP();for(const g of this.g_baf)g.g_Jj(e);const g=this.g_baf.filter(e=>e.g_VM()).map(e=>e.g_bbz());this.g_aZo("state",{tickCount:this.g_bai,audioInstances:g,analysers:[...this.g_bap].map(e=>e.g_bbA())}),0===g.length&&0===this.g_bap.size&&this.g_abv()}g_bbB(e,g){this.g_aZo("trigger",{type:e,tag:g})}async g_bax(_){const a=_.originalUrl,t=_.url,n=_.type,d=_.isMusic,e=_.tag,c=_.isLooping,g=_.vol,o=_.pos,i=_.panning;let b=_.off;if(0<b&&!_.trueClock)if(this.g_a$$.getOutputTimestamp){const e=this.g_a$$.getOutputTimestamp();b=b-e.performanceTime/1e3+e.contextTime}else b=b-performance.now()/1e3+this.g_a$$.currentTime;this.g_bah=e,this.g_bbu(e);try{this.g_bag=await this.g_bbr(a,t,n,e,d),i?(this.g_bag.g_bbC(!0),this.g_bag.g_bbD(i.x,i.y,i.angle,i.innerAngle,i.outerAngle,i.outerGain),i.hasOwnProperty("uid")&&this.g_bag.g_bbE(i.uid)):this.g_bag.g_bbC(!1),this.g_bag.g_KS(c,g,o,b)}catch(e){return void console.error("[Construct 3] Audio: error starting playback: ",e)}finally{this.g_bbw(e)}this.g_abK()}g_aLp(e){const g=e.tag;for(const a of this.g_baZ(g))a.g_Iz()}g_bay(){for(const e of this.g_baf)e.g_Iz()}g_baz(e){const g=e.tag,a=e.paused;for(const _ of this.g_baZ(g))a?_.g_aBd():_.g_KR();this.g_bby()}g_baA(e){const g=e.tag,a=e.vol;for(const _ of this.g_baZ(g))_.g_azN(a)}async g_baB(g){const a=g.tag,_=g.vol,t=g.duration,n=g.stopOnEnd;await this.g_bbx(a);for(const e of this.g_baZ(a))e.g_azO(_,t,n);this.g_bby()}g_baC(e){this.g_ay$=e.vol;for(const g of this.g_baf)g.g_bbF()}g_baD(e){const g=e.tag,a=e.isMuted;for(const _ of this.g_baZ(g))_.g_azM(a)}g_baE(e){this.g_aza=e.isSilent,this.g_aov.g_azU(this.g_aza);for(const g of this.g_baf)g.g_bbG()}g_baF(e){const g=e.tag,a=e.isLooping;for(const _ of this.g_baZ(g))_.g_azL(a)}g_baG(e){const g=e.tag,a=e.rate;for(const _ of this.g_baZ(g))_.g_Ke(a)}g_baH(e){const g=e.tag,a=e.pos;for(const _ of this.g_baZ(g))_.g_azT(a)}async g_baI(g){const a=g.originalUrl,_=g.url,t=g.type,n=g.isMusic;try{await this.g_bbr(a,_,t,"",n)}catch(e){console.error("[Construct 3] Audio: error preloading: ",e)}}async g_F_(g){const a=g.url,_=g.type,t=g.isMusic,n=await this.g_baQ("",a,_,t,!0);if(n){n.g_em();const e=this.g_bae.indexOf(n);-1!==e&&this.g_bae.splice(e,1)}}g_baJ(){for(const e of this.g_bae)e.g_em();this.g_bae.length=0}g_baK(e){const g=e.isSuspended;!g&&this.g_a$$.resume&&this.g_a$$.resume();for(const a of this.g_baf)a.g_api(g);g&&this.g_a$$.suspend&&this.g_a$$.suspend()}g_Ip(e){if(this.g_ahD=e.timeScale,this.g_anQ=e.gameTime,this.g_bai=e.tickCount,0!==this.g_ayO)for(const e of this.g_baf)e.g_bbH();const g=e.listenerPos;g&&this.g_a$$.listener.setPosition(g[0],g[1],g[2]);for(const g of e.instPans){const e=g.uid;for(const a of this.g_baf)a.g_CJ()===e&&a.g_bbI(g.x,g.y,g.angle)}}async g_baL(g){const a=g.type,_=g.tag,t=g.params;let n;if("filter"===a)n=new g_bbJ(this,...t);else if("delay"===a)n=new g_bbK(this,...t);else if("convolution"===a){let e=null;try{e=await this.g_baQ(g.bufferOriginalUrl,g.bufferUrl,g.bufferType,!1)}catch(e){return void console.log("[Construct 3] Audio: error loading convolution: ",e)}n=new g_bbL(this,e.g_bbM(),...t),n.g_bbN(g.bufferOriginalUrl,g.bufferUrl,g.bufferType)}else if("flanger"===a)n=new g_bbO(this,...t);else if("phaser"===a)n=new g_bbP(this,...t);else if("gain"===a)n=new g_bbQ(this,...t);else if("tremolo"===a)n=new g_bbR(this,...t);else if("ringmod"===a)n=new g_bbS(this,...t);else if("distortion"===a)n=new g_bbT(this,...t);else if("compressor"===a)n=new g_bbU(this,...t);else if("analyser"===a)n=new g_bbV(this,...t);else throw new Error("invalid effect type");this.g_baV(_,n),this.g_bbW()}g_baM(_){const a=_.tag,t=_.index,n=_.param,d=_.value,e=_.ramp,i=_.time,g=this.g_bao.get(a);!g||0>t||t>=g.length||(g[t].g_bbX(n,d,e,i),this.g_bbW())}g_baN(e){const g=e.tag.toLowerCase(),_=this.g_bao.get(g);if(_&&_.length){for(const e of _)e.g_em();this.g_bao.delete(g),this.g_baX(g)}}g_bbY(e){this.g_bap.add(e),this.g_bby()}g_bbZ(e){this.g_bap.delete(e)}g_bbW(){this.g_baq||(this.g_baq=!0,Promise.resolve().then(()=>this.g_bb_()))}g_bb_(){const e={};for(const[g,a]of this.g_bao)e[g]=a.map(e=>e.g_bbz());this.g_aZo("fxstate",{fxstate:e}),this.g_baq=!1}async g_baO(e){const g=e.saveLoadMode;if(3!==g)for(const e of this.g_baf)e.g_bbn()&&1===g||!e.g_bbn()&&2===g||e.g_Iz();for(const g of this.g_bao.values())for(const e of g)e.g_em();this.g_bao.clear(),this.g_ahD=e.timeScale,this.g_anQ=e.gameTime;const a=e.listenerPos;this.g_a$$.listener.setPosition(a[0],a[1],a[2]),this.g_aza=e.isSilent,this.g_aov.g_azU(this.g_aza),this.g_ay$=e.masterVolume;const _=[];for(const g of Object.values(e.effects))_.push(Promise.all(g.map(e=>this.g_baL(e))));await Promise.all(_),await Promise.all(e.playing.map(e=>this.g_bb$(e,g))),this.g_bby()}async g_bb$(_,a){if(3===a)return;const t=_.bufferOriginalUrl,n=_.bufferUrl,d=_.bufferType,e=_.isMusic,c=_.tag,g=_.isLooping,o=_.volume,i=_.playbackTime;if(e&&1===a)return;if(!e&&2===a)return;let b=null;try{b=await this.g_bbr(t,n,d,c,e)}catch(e){return void console.error("[Construct 3] Audio: error loading audio state: ",e)}b.g_bca(_.pan),b.g_KS(g,o,i,0),_.isPlaying||b.g_aBd(),b.g_bcb(_)}g_bat(e,g){this.g_bas&&this.g_bas.disconnect(),this.g_bar=g.toLowerCase(),this.g_bas=this.g_a$$.createMediaStreamSource(e),this.g_bas.connect(this.g_baT(this.g_bar))}g_bav(){return this.g_bau||(this.g_bau=this.g_a$$.createMediaStreamDestination(),this.g_baa.connect(this.g_bau)),this.g_bau.stream}};g_aZT.g_a_P(g)}"use strict",self.g_bbq=class{constructor(g,a,_,t,n){this.g_bcc=g,this.g_bcd=a,this.g_Bd=_,this.g_ko=t,this.g_bce=n,this.g_bcf="",this.g_bcg="not-loaded",this.g_Bi=null}g_em(){this.g_bcg="not-loaded",this.g_bcc=null,this.g_Bi=null}static g_pB(g,a,_,t,n){const e="audio/webm; codecs=opus"===t&&!g.g_bbc();return n&&e&&g.g_bbd(),!n||g.g_bbb()||e?new g_bch(g,a,_,t,n,e):new g_bci(g,a,_,t,n)}g_adR(e){return"html5"===this.g_bcf?new g_bcj(this.g_bcc,this,e):new g_bck(this.g_bcc,this,e)}g_FU(){}g_AE(){return this.g_Bi||(this.g_Bi=this.g_FU()),this.g_Bi}g_Bj(){}g_bcl(){}g_bcm(){return"failed"===this.g_bcg}g_baR(){return this.g_bcc.g_baR()}g_bcn(){return this.g_bcf}g_bco(){return this.g_bcd}g_bbp(){return this.g_Bd}g_bcp(){return this.g_ko}g_bbn(){return this.g_bce}g_afz(){}},"use strict",self.g_bci=class extends g_bbq{constructor(g,a,_,t,n){super(g,a,_,t,n),this.g_bcf="html5",this.g_bcq=new Audio,this.g_bcq.crossOrigin="anonymous",this.g_bcq.autoplay=!1,this.g_bcq.preload="auto",this.g_bcr=null,this.g_bcs=null,this.g_bct=!1,this.g_bcq.addEventListener("canplaythrough",()=>this.g_bct=!0),this.g_bcu=this.g_baR().createGain(),this.g_bcv=null,this.g_bcq.addEventListener("canplay",()=>{this.g_bcr&&(this.g_bcg="loaded",this.g_bcr(),this.g_bcr=null,this.g_bcs=null),this.g_bcv||!this.g_bcq||(this.g_bcv=this.g_baR().createMediaElementSource(this.g_bcq),this.g_bcv.connect(this.g_bcu))}),this.onended=null,this.g_bcq.addEventListener("ended",()=>{this.onended&&this.onended()}),this.g_bcq.addEventListener("error",e=>this.g_aCn(e))}g_em(){this.g_bcc.g_bbk(this),this.g_bcu.disconnect(),this.g_bcu=null,this.g_bcv.disconnect(),this.g_bcv=null,this.g_bcq&&!this.g_bcq.paused&&this.g_bcq.pause(),this.onended=null,this.g_bcq=null,super.g_em()}g_FU(){return this.g_bcg="loading",new Promise((e,g)=>{this.g_bcr=e,this.g_bcs=g,this.g_bcq.src=this.g_Bd})}g_aCn(e){console.error(`[Construct 3] Audio '${this.g_Bd}' error: `,e),this.g_bcs&&(this.g_bcg="failed",this.g_bcs(e),this.g_bcr=null,this.g_bcs=null)}g_Bj(){const e=4<=this.g_bcq.readyState;return e&&(this.g_bct=!0),e||this.g_bct}g_bcl(){return this.g_Bj()}g_bcw(){return this.g_bcq}g_bcx(){return this.g_bcu}g_afz(){return this.g_bcq.duration}},"use strict",self.g_bch=class extends g_bbq{constructor(g,a,_,t,n,e){super(g,a,_,t,n),this.g_bcf="webaudio",this.g_bcy=null,this.g_bcz=null,this.g_bcA=!!e}g_em(){this.g_bcc.g_bbk(this),this.g_bcy=null,this.g_bcz=null,super.g_em()}async g_bcB(){if(this.g_bcy)return this.g_bcy;const e=this.g_bcc.g_aZy();if("cordova"===e.g_apV()&&e.g_fT(this.g_Bd))this.g_bcy=await e.g_As(this.g_Bd);else{const e=await fetch(this.g_Bd);if(!e.ok)throw new Error(`error fetching audio data: ${e.status} ${e.statusText}`);this.g_bcy=await e.arrayBuffer()}}async g_bcC(){return this.g_bcz?this.g_bcz:void(this.g_bcz=await this.g_bcc.g_bbj(this.g_bcy,this.g_bcA),this.g_bcy=null)}async g_FU(){try{this.g_bcg="loading",await this.g_bcB(),await this.g_bcC(),this.g_bcg="loaded"}catch(e){this.g_bcg="failed",console.error(`[Construct 3] Failed to load audio '${this.g_Bd}': `,e)}}g_Bj(){return!!(this.g_bcy||this.g_bcz)}g_bcl(){return!!this.g_bcz}g_bbM(){return this.g_bcz}g_afz(){return this.g_bcz?this.g_bcz.duration:0}},"use strict";{function _(g){return g*e}const e=180/Math.PI;self.g_bcD=class{constructor(e,g,a){this.g_bcc=e,this.g_vg=g,this.g_bcE=a,this.g_bcF=this.g_baR().createGain(),this.g_bcF.connect(this.g_baS()),this.g_bcG=null,this.g_bcH=!1,this.g_Sw=!0,this.g_aAQ=!1,this.g_bcI=!1,this.g_ZD=!1,this.g_aAT=1,this.g_aAS=!1,this.g_Jw=1;const _=this.g_bcc.g_bba();this.g_bcJ=1===_&&!this.g_bbn()||2===_,this.g_bcK=-1,this.g_bcL=-1,this.g_bcM=!1}g_em(){this.g_bcc=null,this.g_vg=null,this.g_bcG&&(this.g_bcG.disconnect(),this.g_bcG=null),this.g_bcF.disconnect(),this.g_bcF=null}g_baR(){return this.g_bcc.g_baR()}g_baS(){return this.g_bcc.g_baT(this.g_bcE)}g_ba$(){return this.g_bcc.g_ba$()}g_bcN(){return this.g_bcJ?this.g_bcc.g_EK():performance.now()/1e3}g_bco(){return this.g_vg.g_bco()}g_bbp(){return this.g_vg.g_bbp()}g_bcp(){return this.g_vg.g_bcp()}g_bbl(){return this.g_vg}g_bbn(){return this.g_vg.g_bbn()}g_bbt(e){this.g_bcE=e}g_bbo(){return this.g_bcE}g_aA$(){}g_bbs(){}g_Kh(){return!this.g_Sw&&!this.g_aAQ&&!this.g_aA$()}g_VM(){return!this.g_Sw&&!this.g_aA$()}g_bcO(){}g_afz(e){let g=this.g_vg.g_afz();return e&&(g/=this.g_Jw||.001),g}g_KS(){}g_Iz(){}g_aBd(){}g_aA_(){return this.g_aAQ}g_KR(){}g_azN(e){this.g_aAT=e,this.g_bcF.gain.cancelScheduledValues(0),this.g_bcL=-1,this.g_bcF.gain.value=this.g_bcP()}g_azO(g,_,t){if(!this.g_aBa()){g*=this.g_ba$();const a=this.g_bcF.gain;a.cancelScheduledValues(0);const n=this.g_bcc.g_baP(),e=n+_;a.setValueAtTime(this.g_bcP(),n),a.linearRampToValueAtTime(g,e),this.g_aAT=g,this.g_bcL=e,this.g_bcM=t}}g_bbF(){this.g_azN(this.g_aAT)}g_Jj(e){-1!==this.g_bcL&&e>=this.g_bcL&&(this.g_bcL=-1,this.g_bcM&&this.g_Iz(),this.g_bcc.g_bbB("fade-ended",this.g_bcE))}g_bcP(){const e=this.g_aAT*this.g_ba$();return isFinite(e)?e:0}g_azM(e){e=!!e,this.g_aAS===e||(this.g_aAS=e,this.g_bbG())}g_aBa(){return this.g_aAS}g_azD(){return this.g_bcc.g_azD()}g_bbG(){}g_azL(){}g_Xs(){return this.g_ZD}g_Ke(e){this.g_Jw===e||(this.g_Jw=e,this.g_bbH())}g_bbH(){}g_Kf(){return this.g_Jw}g_azT(){}g_api(){}g_bbC(e){e=!!e,this.g_bcH===e||(this.g_bcH=e,this.g_bcH?(!this.g_bcG&&(this.g_bcG=this.g_baR().createPanner(),this.g_bcG.panningModel=this.g_bcc.g_bbe(),this.g_bcG.distanceModel=this.g_bcc.g_bbf(),this.g_bcG.refDistance=this.g_bcc.g_bbg(),this.g_bcG.maxDistance=this.g_bcc.g_bbh(),this.g_bcG.rolloffFactor=this.g_bcc.g_bbi()),this.g_bcF.disconnect(),this.g_bcF.connect(this.g_bcG),this.g_bcG.connect(this.g_baS())):(this.g_bcG.disconnect(),this.g_bcF.disconnect(),this.g_bcF.connect(this.g_baS())))}g_bbD(a,t,n,d,e,i){this.g_bcH&&(this.g_bbI(a,t,n),this.g_bcG.coneInnerAngle=_(d),this.g_bcG.coneOuterAngle=_(e),this.g_bcG.coneOuterGain=i)}g_bbI(e,g,a){this.g_bcH&&(this.g_bcG.setPosition(e,g,0),this.g_bcG.setOrientation(Math.cos(a),Math.sin(a),0))}g_bbE(e){this.g_bcK=e}g_CJ(){return this.g_bcK}g_bcQ(){}g_ba_(e){const g=this.g_bcG||this.g_bcF;g.disconnect(),g.connect(e)}g_bbz(){return{tag:this.g_bcE,duration:this.g_afz(),volume:this.g_aAT,isPlaying:this.g_Kh(),playbackTime:this.g_bcO(),playbackRate:this.g_Kf(),uid:this.g_bcK,bufferOriginalUrl:this.g_bco(),bufferUrl:"",bufferType:this.g_bcp(),isMusic:this.g_bbn(),isLooping:this.g_Xs(),isMuted:this.g_aBa(),resumePosition:this.g_bcQ(),pan:this.g_bcR()}}g_bcb(e){this.g_Ke(e.playbackRate),this.g_azM(e.isMuted)}g_bcR(){if(!this.g_bcG)return null;const e=this.g_bcG;return{pos:[e.positionX.value,e.positionY.value,e.positionZ.value],orient:[e.orientationX.value,e.orientationY.value,e.orientationZ.value],cia:e.coneInnerAngle,coa:e.coneOuterAngle,cog:e.coneOuterGain,uid:this.g_bcK}}g_bca(e){if(!e)return void this.g_bbC(!1);this.g_bbC(!0);const g=this.g_bcG;g.setPosition(...g.pos),g.setOrientation(...g.orient),g.coneInnerAngle=g.cia,g.coneOuterAngle=g.coa,g.coneOuterGain=g.cog,this.g_bcK=g.uid}}}"use strict",self.g_bcj=class extends g_bcD{constructor(e,g,a){super(e,g,a),this.g_vg.g_bcx().connect(this.g_bcF),this.g_vg.onended=()=>this.g_bcS()}g_em(){this.g_Iz(),this.g_vg.g_bcx().disconnect(),super.g_em()}g_bcw(){return this.g_vg.g_bcw()}g_bcS(){this.g_Sw=!0,this.g_bcK=-1,this.g_bcc.g_bbB("ended",this.g_bcE)}g_aA$(){return this.g_bcw().ended}g_bbs(){return!!this.g_Sw||this.g_aA$()}g_bcO(e){let g=this.g_bcw().currentTime;return e&&(g*=this.g_Jw),this.g_ZD||(g=Math.min(g,this.g_afz())),g}g_KS(e,g,_){const a=this.g_bcw();if(1!==a.playbackRate&&(a.playbackRate=1),a.loop!==e&&(a.loop=e),this.g_azN(g),a.muted&&(a.muted=!1),a.currentTime!==_)try{a.currentTime=_}catch(e){console.warn(`[Construct 3] Exception seeking audio '${this.g_vg.g_bbp()}' to position '${_}': `,e)}this.g_bcc.g_a_S(a),this.g_Sw=!1,this.g_aAQ=!1,this.g_ZD=e,this.g_Jw=1}g_Iz(){const e=this.g_bcw();e.paused||e.pause(),this.g_bcc.g_a_T(e),this.g_Sw=!0,this.g_aAQ=!1,this.g_bcK=-1}g_aBd(){if(!(this.g_aAQ||this.g_Sw||this.g_aA$())){const e=this.g_bcw();e.paused||e.pause(),this.g_bcc.g_a_T(e),this.g_aAQ=!0}}g_KR(){!this.g_aAQ||this.g_Sw||this.g_aA$()||(this.g_bcc.g_a_S(this.g_bcw()),this.g_aAQ=!1)}g_bbG(){this.g_bcw().muted=this.g_aAS||this.g_azD()}g_azL(e){e=!!e,this.g_ZD===e||(this.g_ZD=e,this.g_bcw().loop=e)}g_bbH(){let e=this.g_Jw;this.g_bcJ&&(e*=this.g_bcc.g_Jh());try{this.g_bcw().playbackRate=e}catch(g){console.warn(`[Construct 3] Unable to set playback rate '${e}':`,g)}}g_azT(e){if(!(this.g_Sw||this.g_aA$()))try{this.g_bcw().currentTime=e}catch(g){console.warn(`[Construct 3] Error seeking audio to '${e}': `,g)}}g_bcQ(){return this.g_bcO()}g_api(e){e?this.g_Kh()?(this.g_bcw().pause(),this.g_bcI=!0):this.g_bcI=!1:this.g_bcI&&(this.g_bcc.g_a_S(this.g_bcw()),this.g_bcI=!1)}},"use strict",self.g_bck=class extends g_bcD{constructor(e,g,a){super(e,g,a),this.g_bcT=null,this.g_bcU=e=>this.g_bcS(e),this.g_bcV=!0,this.g_bcW=null,this.g_anL=0,this.g_bcX=0,this.g_bcY=1}g_em(){this.g_Iz(),this.g_bcZ(),this.g_bcU=null,super.g_em()}g_bcZ(){this.g_bcT&&this.g_bcT.disconnect(),this.g_bcT=null,this.g_bcW=null}g_bcS(e){this.g_aAQ||this.g_bcI||e.target!==this.g_bcW||(this.g_bcV=!0,this.g_Sw=!0,this.g_bcK=-1,this.g_bcZ(),this.g_bcc.g_bbB("ended",this.g_bcE))}g_aA$(){return!(!this.g_Sw&&this.g_bcT&&this.g_bcT.loop)&&!this.g_aAQ&&this.g_bcV}g_bbs(){return!this.g_bcT||this.g_Sw||this.g_aA$()}g_bcO(e){let g=0;return g=this.g_aAQ?this.g_bcX:this.g_bcN()-this.g_anL,e&&(g*=this.g_Jw),this.g_ZD||(g=Math.min(g,this.g_afz())),g}g_KS(e,g,a,_){this.g_bcY=1,this.g_azN(g),this.g_bcZ(),this.g_bcT=this.g_baR().createBufferSource(),this.g_bcT.buffer=this.g_vg.g_bbM(),this.g_bcT.connect(this.g_bcF),this.g_bcW=this.g_bcT,this.g_bcT.onended=this.g_bcU,this.g_bcT.loop=e,this.g_bcT.start(_,a),this.g_bcV=!1,this.g_Sw=!1,this.g_aAQ=!1,this.g_ZD=e,this.g_Jw=1,this.g_anL=this.g_bcN()-a}g_Iz(){this.g_bcT&&this.g_bcT.stop(0),this.g_Sw=!0,this.g_aAQ=!1,this.g_bcK=-1}g_aBd(){this.g_aAQ||this.g_Sw||this.g_aA$()||(this.g_bcX=this.g_bcO(!0),this.g_ZD&&(this.g_bcX%=this.g_afz()),this.g_aAQ=!0,this.g_bcT.stop(0))}g_KR(){!this.g_aAQ||this.g_Sw||this.g_aA$()||(this.g_bcZ(),this.g_bcT=this.g_baR().createBufferSource(),this.g_bcT.buffer=this.g_vg.g_bbM(),this.g_bcT.connect(this.g_bcF),this.g_bcW=this.g_bcT,this.g_bcT.onended=this.g_bcU,this.g_bcT.loop=this.g_ZD,this.g_bbF(),this.g_bbH(),this.g_anL=this.g_bcN()-this.g_bcX/(this.g_Jw||.001),this.g_bcT.start(0,this.g_bcX),this.g_aAQ=!1)}g_bcP(){return super.g_bcP()*this.g_bcY}g_bbG(){this.g_bcY=this.g_aAS||this.g_azD()?0:1,this.g_bbF()}g_azL(e){e=!!e,this.g_ZD===e||(this.g_ZD=e,this.g_bcT&&(this.g_bcT.loop=e))}g_bbH(){let e=this.g_Jw;this.g_bcJ&&(e*=this.g_bcc.g_Jh()),this.g_bcT&&(this.g_bcT.playbackRate.value=e)}g_azT(e){this.g_Sw||this.g_aA$()||(this.g_aAQ?this.g_bcX=e:(this.g_aBd(),this.g_bcX=e,this.g_KR()))}g_bcQ(){return this.g_bcX}g_api(e){e?this.g_Kh()?(this.g_bcI=!0,this.g_bcX=this.g_bcO(!0),this.g_ZD&&(this.g_bcX%=this.g_afz()),this.g_bcT.stop(0)):this.g_bcI=!1:this.g_bcI&&(this.g_bcZ(),this.g_bcT=this.g_baR().createBufferSource(),this.g_bcT.buffer=this.g_vg.g_bbM(),this.g_bcT.connect(this.g_bcF),this.g_bcW=this.g_bcT,this.g_bcT.onended=this.g_bcU,this.g_bcT.loop=this.g_ZD,this.g_bbF(),this.g_bbH(),this.g_anL=this.g_bcN()-this.g_bcX/(this.g_Jw||.001),this.g_bcT.start(0,this.g_bcX),this.g_bcI=!1)}g_bcb(e){super.g_bcb(e),this.g_bcX=e.resumePosition}},"use strict";{function g(e){return Math.pow(10,e/20)}function _(e){return Math.max(Math.min(g(e),1),0)}function t(e){return 20*(Math.log(e)/2.302585092994046)}function n(e){return t(Math.max(Math.min(e,1),0))}function i(e,g){return 1-Math.exp(-g*e)}class e{constructor(e){this.g_bcc=e,this.g_a$$=e.g_baR(),this.g_BS=-1,this.g_bcE="",this.g_ko="",this.g_bc_=null}g_em(){this.g_a$$=null}g_ajk(e){this.g_BS=e}g_Dl(){return this.g_BS}g_baW(e){this.g_bcE=e}g_bbo(){return this.g_bcE}g_bc$(){return this.g_a$$.createGain()}g_baU(){}g_baY(){}g_bda(g,a,_,t){if(g.cancelScheduledValues(0),0===t)return void(g.value=a);const n=this.g_a$$.currentTime;t+=n,0===_?g.setValueAtTime(a,t):1===_?(g.setValueAtTime(g.value,n),g.linearRampToValueAtTime(a,t)):2===_?(g.setValueAtTime(g.value,n),g.exponentialRampToValueAtTime(a,t)):void 0}g_bbz(){return{type:this.g_ko,tag:this.g_bcE,params:this.g_bc_}}}self.g_bbJ=class extends e{constructor(_,a,t,n,d,e,i){super(_),this.g_ko="filter",this.g_bc_=[a,t,n,d,e,i],this.g_bdb=this.g_bc$(),this.g_bdc=this.g_bc$(),this.g_bdc.gain.value=i,this.g_bdd=this.g_bc$(),this.g_bdd.gain.value=1-i,this.g_bde=this.g_a$$.createBiquadFilter(),this.g_bde.type=a,this.g_bde.frequency.value=t,this.g_bde.detune.value=n,this.g_bde.Q.value=d,this.g_bde.gain.vlaue=e,this.g_bdb.connect(this.g_bde),this.g_bdb.connect(this.g_bdd),this.g_bde.connect(this.g_bdc)}g_em(){this.g_bdb.disconnect(),this.g_bde.disconnect(),this.g_bdc.disconnect(),this.g_bdd.disconnect(),super.g_em()}g_baY(e){this.g_bdc.disconnect(),this.g_bdc.connect(e),this.g_bdd.disconnect(),this.g_bdd.connect(e)}g_baU(){return this.g_bdb}g_bbX(e,g,a,_){0===e?(g=Math.max(Math.min(g/100,1),0),this.g_bc_[5]=g,this.g_bda(this.g_bdc.gain,g,a,_),this.g_bda(this.g_bdd.gain,1-g,a,_)):1===e?(this.g_bc_[1]=g,this.g_bda(this.g_bde.frequency,g,a,_)):2===e?(this.g_bc_[2]=g,this.g_bda(this.g_bde.detune,g,a,_)):3===e?(this.g_bc_[3]=g,this.g_bda(this.g_bde.Q,g,a,_)):4===e?(this.g_bc_[4]=g,this.g_bda(this.g_bde.gain,g,a,_)):void 0}},self.g_bbK=class extends e{constructor(e,g,a,_){super(e),this.g_ko="delay",this.g_bc_=[g,a,_],this.g_bdb=this.g_bc$(),this.g_bdc=this.g_bc$(),this.g_bdc.gain.value=_,this.g_bdd=this.g_bc$(),this.g_bdd.gain.value=1-_,this.g_bdf=this.g_bc$(),this.g_bdg=this.g_a$$.createDelay(g),this.g_bdg.delayTime.value=g,this.g_bdh=this.g_bc$(),this.g_bdh.gain.value=a,this.g_bdb.connect(this.g_bdf),this.g_bdb.connect(this.g_bdd),this.g_bdf.connect(this.g_bdc),this.g_bdf.connect(this.g_bdg),this.g_bdg.connect(this.g_bdh),this.g_bdh.connect(this.g_bdf)}g_em(){this.g_bdb.disconnect(),this.g_bdc.disconnect(),this.g_bdd.disconnect(),this.g_bdf.disconnect(),this.g_bdg.disconnect(),this.g_bdh.disconnect(),super.g_em()}g_baY(e){this.g_bdc.disconnect(),this.g_bdc.connect(e),this.g_bdd.disconnect(),this.g_bdd.connect(e)}g_baU(){return this.g_bdb}g_bbX(g,a,t,n){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_bc_[2]=a,this.g_bda(this.g_bdc.gain,a,t,n),this.g_bda(this.g_bdd.gain,1-a,t,n)):4===g?(this.g_bc_[1]=_(a),this.g_bda(this.g_bdh.gain,_(a),t,n)):5===g?(this.g_bc_[0]=a,this.g_bda(this.g_bdg.delayTime,a,t,n)):void 0}},self.g_bbL=class extends e{constructor(e,g,a,_){super(e),this.g_ko="convolution",this.g_bc_=[a,_],this.g_bdi="",this.g_bdj="",this.g_bdk="",this.g_bdb=this.g_bc$(),this.g_bdc=this.g_bc$(),this.g_bdc.gain.value=_,this.g_bdd=this.g_bc$(),this.g_bdd.gain.value=1-_,this.g_bdl=this.g_a$$.createConvolver(),this.g_bdl.normalize=a,this.g_bdl.buffer=g,this.g_bdb.connect(this.g_bdl),this.g_bdb.connect(this.g_bdd),this.g_bdl.connect(this.g_bdc)}g_em(){this.g_bdb.disconnect(),this.g_bdl.disconnect(),this.g_bdc.disconnect(),this.g_bdd.disconnect(),super.g_em()}g_baY(e){this.g_bdc.disconnect(),this.g_bdc.connect(e),this.g_bdd.disconnect(),this.g_bdd.connect(e)}g_baU(){return this.g_bdb}g_bbX(e,g,a,_){0===e?(g=Math.max(Math.min(g/100,1),0),this.g_bc_[1]=g,this.g_bda(this.g_bdc.gain,g,a,_),this.g_bda(this.g_bdd.gain,1-g,a,_)):void 0}g_bbN(e,g,a){this.g_bdi=e,this.g_bdj=g,this.g_bdk=a}g_bbz(){const e=super.g_bbz();return e.bufferOriginalUrl=this.g_bdi,e.bufferUrl="",e.bufferType=this.g_bdk,e}},self.g_bbO=class extends e{constructor(g,a,_,t,n,e){super(g),this.g_ko="flanger",this.g_bc_=[a,_,t,n,e],this.g_bdb=this.g_bc$(),this.g_bdd=this.g_bc$(),this.g_bdd.gain.value=1-e/2,this.g_bdc=this.g_bc$(),this.g_bdc.gain.value=e/2,this.g_bdm=this.g_bc$(),this.g_bdm.gain.value=n,this.g_bdg=this.g_a$$.createDelay(a+_),this.g_bdg.delayTime.value=a,this.g_bdn=this.g_a$$.createOscillator(),this.g_bdn.frequency.value=t,this.g_bdo=this.g_bc$(),this.g_bdo.gain.value=_,this.g_bdb.connect(this.g_bdg),this.g_bdb.connect(this.g_bdd),this.g_bdg.connect(this.g_bdc),this.g_bdg.connect(this.g_bdm),this.g_bdm.connect(this.g_bdg),this.g_bdn.connect(this.g_bdo),this.g_bdo.connect(this.g_bdg.delayTime),this.g_bdn.start(0)}g_em(){this.g_bdn.stop(0),this.g_bdb.disconnect(),this.g_bdg.disconnect(),this.g_bdn.disconnect(),this.g_bdo.disconnect(),this.g_bdd.disconnect(),this.g_bdc.disconnect(),this.g_bdm.disconnect(),super.g_em()}g_baY(e){this.g_bdc.disconnect(),this.g_bdc.connect(e),this.g_bdd.disconnect(),this.g_bdd.connect(e)}g_baU(){return this.g_bdb}g_bbX(e,g,a,_){0===e?(g=Math.max(Math.min(g/100,1),0),this.g_bc_[4]=g,this.g_bda(this.g_bdc.gain,g/2,a,_),this.g_bda(this.g_bdd.gain,1-g/2,a,_)):6===e?(this.g_bc_[1]=g/1e3,this.g_bda(this.g_bdo.gain,g/1e3,a,_)):7===e?(this.g_bc_[2]=g,this.g_bda(this.g_bdn.frequency,g,a,_)):8===e?(this.g_bc_[3]=g/100,this.g_bda(this.g_bdm.gain,g/100,a,_)):void 0}},self.g_bbP=class extends e{constructor(_,a,t,n,d,e,i){super(_),this.g_ko="phaser",this.g_bc_=[a,t,n,d,e,i],this.g_bdb=this.g_bc$(),this.g_bdd=this.g_bc$(),this.g_bdd.gain.value=1-i/2,this.g_bdc=this.g_bc$(),this.g_bdc.gain.value=i/2,this.g_bde=this.g_a$$.createBiquadFilter(),this.g_bde.type="allpass",this.g_bde.frequency.value=a,this.g_bde.detune.value=t,this.g_bde.Q.value=n,this.g_bdn=this.g_a$$.createOscillator(),this.g_bdn.frequency.value=e,this.g_bdo=this.g_bc$(),this.g_bdo.gain.value=d,this.g_bdb.connect(this.g_bde),this.g_bdb.connect(this.g_bdd),this.g_bde.connect(this.g_bdc),this.g_bdn.connect(this.g_bdo),this.g_bdo.connect(this.g_bde.frequency),this.g_bdn.start(0)}g_em(){this.g_bdn.stop(0),this.g_bdb.disconnect(),this.g_bde.disconnect(),this.g_bdn.disconnect(),this.g_bdo.disconnect(),this.g_bdd.disconnect(),this.g_bdc.disconnect(),super.g_em()}g_baY(e){this.g_bdc.disconnect(),this.g_bdc.connect(e),this.g_bdd.disconnect(),this.g_bdd.connect(e)}g_baU(){return this.g_bdb}g_bbX(e,g,a,_){0===e?(g=Math.max(Math.min(g/100,1),0),this.g_bc_[5]=g,this.g_bda(this.g_bdc.gain,g/2,a,_),this.g_bda(this.g_bdd.gain,1-g/2,a,_)):1===e?(this.g_bc_[0]=g,this.g_bda(this.g_bde.frequency,g,a,_)):2===e?(this.g_bc_[1]=g,this.g_bda(this.g_bde.detune,g,a,_)):3===e?(this.g_bc_[2]=g,this.g_bda(this.g_bde.Q,g,a,_)):6===e?(this.g_bc_[3]=g,this.g_bda(this.g_bdo.gain,g,a,_)):7===e?(this.g_bc_[4]=g,this.g_bda(this.g_bdn.frequency,g,a,_)):void 0}},self.g_bbQ=class extends e{constructor(e,g){super(e),this.g_ko="gain",this.g_bc_=[g],this.g_bdp=this.g_bc$(),this.g_bdp.gain.value=g}g_em(){this.g_bdp.disconnect(),super.g_em()}g_baY(e){this.g_bdp.disconnect(),this.g_bdp.connect(e)}g_baU(){return this.g_bdp}g_bbX(g,a,t,n){4===g?(this.g_bc_[0]=_(a),this.g_bda(this.g_bdp.gain,_(a),t,n)):void 0}},self.g_bbR=class extends e{constructor(e,g,a){super(e),this.g_ko="tremolo",this.g_bc_=[g,a],this.g_bdp=this.g_bc$(),this.g_bdp.gain.value=1-a/2,this.g_bdn=this.g_a$$.createOscillator(),this.g_bdn.frequency.value=g,this.g_bdo=this.g_bc$(),this.g_bdo.gain.value=a/2,this.g_bdn.connect(this.g_bdo),this.g_bdo.connect(this.g_bdp.gain),this.g_bdn.start(0)}g_em(){this.g_bdn.stop(0),this.g_bdn.disconnect(),this.g_bdo.disconnect(),this.g_bdp.disconnect(),super.g_em()}g_baY(e){this.g_bdp.disconnect(),this.g_bdp.connect(e)}g_baU(){return this.g_bdp}g_bbX(e,g,a,_){0===e?(g=Math.max(Math.min(g/100,1),0),this.g_bc_[1]=g,this.g_bda(this.g_bdp.gain.value,1-g/2,a,_),this.g_bda(this.g_bdo.gain.value,g/2,a,_)):7===e?(this.g_bc_[0]=g,this.g_bda(this.g_bdn.frequency,g,a,_)):void 0}},self.g_bbS=class extends e{constructor(e,g,a){super(e),this.g_ko="ringmod",this.g_bc_=[g,a],this.g_bdb=this.g_bc$(),this.g_bdc=this.g_bc$(),this.g_bdc.gain.value=a,this.g_bdd=this.g_bc$(),this.g_bdd.gain.value=1-a,this.g_bdq=this.g_bc$(),this.g_bdq.gain.value=0,this.g_bdn=this.g_a$$.createOscillator(),this.g_bdn.frequency.value=g,this.g_bdn.connect(this.g_bdq.gain),this.g_bdn.start(0),this.g_bdb.connect(this.g_bdq),this.g_bdb.connect(this.g_bdd),this.g_bdq.connect(this.g_bdc)}g_em(){this.g_bdn.stop(0),this.g_bdn.disconnect(),this.g_bdq.disconnect(),this.g_bdb.disconnect(),this.g_bdc.disconnect(),this.g_bdd.disconnect(),super.g_em()}g_baY(e){this.g_bdc.disconnect(),this.g_bdc.connect(e),this.g_bdd.disconnect(),this.g_bdd.connect(e)}g_baU(){return this.g_bdb}g_bbX(e,g,a,_){0===e?(g=Math.max(Math.min(g/100,1),0),this.g_bc_[1]=g,this.g_bda(this.g_bdc.gain,g,a,_),this.g_bda(this.g_bdd.gain,1-g,a,_)):7===e?(this.g_bc_[0]=g,this.g_bda(this.g_bdn.frequency,g,a,_)):void 0}},self.g_bbT=class extends e{constructor(g,a,_,t,n,e){super(g),this.g_ko="distortion",this.g_bc_=[a,_,t,n,e],this.g_bdb=this.g_bc$(),this.g_bdr=this.g_bc$(),this.g_bds=this.g_bc$(),this.g_bdt(t,n),this.g_bdc=this.g_bc$(),this.g_bdc.gain.value=e,this.g_bdd=this.g_bc$(),this.g_bdd.gain.value=1-e,this.g_bdu=this.g_a$$.createWaveShaper(),this.g_bdv=new Float32Array(65536),this.g_bdw(a,_),this.g_bdu.curve=this.g_bdv,this.g_bdb.connect(this.g_bdr),this.g_bdb.connect(this.g_bdd),this.g_bdr.connect(this.g_bdu),this.g_bdu.connect(this.g_bds),this.g_bds.connect(this.g_bdc)}g_em(){this.g_bdb.disconnect(),this.g_bdr.disconnect(),this.g_bdu.disconnect(),this.g_bds.disconnect(),this.g_bdc.disconnect(),this.g_bdd.disconnect(),super.g_em()}g_bdt(e,g){.01>e&&(e=.01),this.g_bdr.gain.value=e,this.g_bds.gain.value=Math.pow(1/e,.6)*g}g_bdw(e,g){for(let a,_=0;32768>_;++_)a=_/32768,a=this.g_bdx(a,e,g),this.g_bdv[32768+_]=a,this.g_bdv[32768-_-1]=-a}g_bdx(e,a,_){const t=1.05*_*a-a,n=0>e?-1:1,d=0>e?-e:e;let g=d<a?d:a+t*i(d-a,1/t);return g*=n,g}g_baY(e){this.g_bdc.disconnect(),this.g_bdc.connect(e),this.g_bdd.disconnect(),this.g_bdd.connect(e)}g_baU(){return this.g_bdb}g_bbX(e,g,a,_){0===e?(g=Math.max(Math.min(g/100,1),0),this.g_bc_[4]=g,this.g_bda(this.g_bdc.gain,g,a,_),this.g_bda(this.g_bdd.gain,1-g,a,_)):void 0}},self.g_bbU=class extends e{constructor(g,a,_,t,n,e){super(g),this.g_ko="compressor",this.g_bc_=[a,_,t,n,e],this.g_bdp=this.g_a$$.createDynamicsCompressor(),this.g_bdp.threshold.value=a,this.g_bdp.knee.value=_,this.g_bdp.ratio.value=t,this.g_bdp.attack.value=n,this.g_bdp.release.value=e}g_em(){this.g_bdp.disconnect(),super.g_em()}g_baY(e){this.g_bdp.disconnect(),this.g_bdp.connect(e)}g_baU(){return this.g_bdp}g_bbX(){}},self.g_bbV=class extends e{constructor(e,g,a){super(e),this.g_ko="analyser",this.g_bc_=[g,a],this.g_bdp=this.g_a$$.createAnalyser(),this.g_bdp.fftSize=g,this.g_bdp.smoothingTimeConstant=a,this.g_bdy=new Float32Array(this.g_bdp.frequencyBinCount),this.g_bdz=new Uint8Array(g),this.g_bdA=0,this.g_bdB=0,this.g_bcc.g_bbY(this)}g_em(){this.g_bcc.g_bbZ(this),this.g_bdp.disconnect(),super.g_em()}g_Jj(){this.g_bdp.getFloatFrequencyData(this.g_bdy),this.g_bdp.getByteTimeDomainData(this.g_bdz);const e=this.g_bdp.fftSize;this.g_bdA=0;let g=0;for(let a,_=0;_<e;++_)a=(this.g_bdz[_]-128)/128,0>a&&(a=-a),this.g_bdA<a&&(this.g_bdA=a),g+=a*a;this.g_bdA=n(this.g_bdA),this.g_bdB=n(Math.sqrt(g/e))}g_baY(e){this.g_bdp.disconnect(),this.g_bdp.connect(e)}g_baU(){return this.g_bdp}g_bbX(){}g_bbA(){return{tag:this.g_bbo(),index:this.g_Dl(),peak:this.g_bdA,rms:this.g_bdB,binCount:this.g_bdp.frequencyBinCount,freqBins:this.g_bdy}}}}{function e(e){return e&&!e.paused&&!e.ended&&0<e.currentTime}const g=class extends g_aZC{constructor(e){super(e,"video"),this.g_aZL(!1),this.g_bdC=!1,this.g_bdD=0,this.g_bdE=new WeakSet,this.g_aZv("init",e=>this.g_bdF(e)),this.g_aZM("play",e=>this.g_bdG(e)),this.g_aZM("pause",e=>this.g_bdH(e)),this.g_aZM("set-source",(e,g)=>this.g_bdI(e,g)),this.g_aZM("set-playback-time",(e,g)=>this.g_bdJ(e,g)),this.g_aZM("set-looping",(e,g)=>this.g_bdK(e,g)),this.g_aZM("set-muted",(e,g)=>this.g_bdL(e,g)),this.g_aZM("set-volume",(e,g)=>this.g_bdM(e,g)),self.C3Video_GetElement=e=>this.g_aZR(e)}async g_bdF(e){this.g_abK(),this.g_bdC=e.isInWorker;const g=document.createElement("video");return{"video/webm":!!g.canPlayType("video/webm"),"video/ogg":!!g.canPlayType("video/ogg"),"video/mp4":!!g.canPlayType("video/mp4")}}g_a_S(e){this.g_aov.g_a_S(e)}g_a_T(e){this.g_aov.g_a_T(e)}g_bdN(){this.g_aov.g_a_U()}g_aci(e,g){const a=document.createElement("video");a.crossOrigin="anonymous",a.playsInline=!0,a.addEventListener("canplay",()=>this.g_bdO(a,e,0)),a.addEventListener("canplaythrough",()=>this.g_bdO(a,e,1)),a.addEventListener("ended",()=>this.g_bdO(a,e,2)),a.addEventListener("error",()=>this.g_bdO(a,e,3)),a.addEventListener("loadstart",()=>this.g_bdO(a,e,4)),a.addEventListener("playing",()=>this.g_bdO(a,e,5)),a.addEventListener("pause",()=>this.g_bdO(a,e,6)),a.addEventListener("stalled",()=>this.g_bdO(a,e,7));const _=g.autoplay;return 0===_?(a.autoplay=!1,a.preload="none"):1===_?(a.autoplay=!1,a.preload="auto"):a.autoplay=!0,a.src=g.src,2===_&&this.g_a_S(a),a}g_bdO(e,g,a){this.g_bdE.has(e)||this.g_aZO("playback-event",g,{type:a})}g_aZQ(){}g_aZN(g){this.g_a_T(g),e(g)&&g.pause(),g.src="",this.g_bdE.add(g)}g_bdG(e){this.g_a_S(e)}g_bdH(e){this.g_a_T(e),e.pause()}g_bdI(e,g){e.src=g.src,e.load()}g_bdJ(e,g){try{e.currentTime=g.time}catch(e){console.error("[Video] Exception setting playback time: ",e)}}g_bdK(e,g){e.loop=g.isLooping}g_bdL(e,g){e.muted=g.isMuted}g_bdM(e,g){e.volume=g.volume}g_Jj(){const g={},e={sequenceNumber:this.g_bdD++,videoData:g},_=[],a=[];for(const[t,n]of this.g_aZD.entries()){const e={currentTime:n.currentTime,duration:n.duration,videoWidth:n.videoWidth,videoHeight:n.videoHeight};this.g_bdC&&a.push(createImageBitmap(n).then(g=>{e.imageBitmap=g,_.push(g)}).catch(()=>{e.imageBitmap=null})),g[t.toString()]=e}Promise.all(a).then(()=>this.g_aZo("state",e,!1,_))}};g_aZT.g_a_P(g)}{const e=class extends g_aZC{constructor(e){super(e,"user-media"),this.g_aZL(!1),this.g_bdC=this.g_aov.g_aZt(),this.g_bdD=0,this.g_bdP=null,this.g_aZv("get-media-sources",()=>this.g_bdQ()),this.g_aZM("request-camera",(e,g)=>this.g_bdR(e,g)),this.g_aZM("request-microphone",(e,g)=>this.g_bdS(e,g)),this.g_aZM("snapshot",(e,g)=>this.g_bdT(e,g)),this.g_aZM("stop",e=>this.g_aLp(e)),self.C3UserMedia_GetVideoElement=e=>this.g_aZR(e),self.C3UserMedia_GetLastMediaStream=()=>this.g_bdP}g_aci(e){const g=document.createElement("video");return g.crossOrigin="anonymous",g.autoplay=!0,g.muted=!0,g.playsInline=!0,g.addEventListener("canplaythrough",()=>{this.g_aZO("video-ready",e,{width:g.videoWidth,height:g.videoHeight})}),g}g_aZQ(){}g_aZN(e){e.srcObject&&(this.g_bdU(e.srcObject),e.srcObject=null)}g_bdU(e){this.g_bdP===e&&(this.g_bdP=null);const g=e.getTracks();for(let a=0,_=g.length;a<_;++a)g[a].stop()}async g_bdQ(){const g=[],a=[];if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){const e=await navigator.mediaDevices.enumerateDevices();for(const _ of e){const t=_.kind,n={deviceId:_.deviceId,label:_.label,facing:_.facing||_.facingMode||""};"video"===t||"videoinput"===t?g.push(n):("audio"===t||"audioinput"===t)&&a.push(n)}}return{videoSources:g,audioSources:a}}g_bdV(){const e=window.cordova&&window.cordova.plugins&&window.cordova.plugins.permissions;if("object"!=typeof e)throw new Error("Permission API is not loaded");return e}g_bdW(e,g){const a=e[g];if("string"!=typeof a)throw new Error("Invalid permission name");return a}g_bdX(e){const g=this.g_bdV();return new Promise((_,a)=>g.checkPermission(this.g_bdW(g,e),e=>_(!!e.hasPermission),a))}g_bdY(e){const g=this.g_bdV();return new Promise((_,a)=>g.requestPermission(this.g_bdW(g,e),e=>_(!!e.hasPermission),a))}async g_bdZ(e){const g=this.g_aZy();if("cordova"!==g.g_apV())return!0;if(g.g_aoN())return!0;for(const g of e){const e=await this.g_bdX(g);if(e)continue;const a=await this.g_bdY(g);if(!1===a)return!1}return!0}async g_bd_(...e){if(!1===(await this.g_bdZ(e)))throw new Error("Permission not granted")}async g_bdR(e,g){try{const a="object"==typeof g.constraints.audio;return a?await this.g_bd_("CAMERA","RECORD_AUDIO","MODIFY_AUDIO_SETTINGS"):await this.g_bd_("CAMERA"),this.g_bdP=await navigator.mediaDevices.getUserMedia(g.constraints),e.srcObject=this.g_bdP,e.play(),this.g_bdC&&this.g_abK(),{ok:!0}}catch(e){return console.warn("Error requesting camera: ",e),{ok:!1}}}async g_bdS(e,g){try{return await this.g_bd_("RECORD_AUDIO","MODIFY_AUDIO_SETTINGS"),this.g_bdP=await navigator.mediaDevices.getUserMedia(g.constraints),self.C3Audio_OnMicrophoneStream&&self.C3Audio_OnMicrophoneStream(this.g_bdP,g.tag),{ok:!0}}catch(e){return console.warn("Error requesting microphone: ",e),{ok:!1}}}g_bd$(e,g,a){return new Promise(_=>{e.toBlob?e.toBlob(e=>_(URL.createObjectURL(e)),g,a):_(e.toDataURL(g,a))})}async g_bdT(g,a){const _=document.createElement("canvas");_.width=g.videoWidth,_.height=g.videoHeight;const t=_.getContext("2d");t.drawImage(g,0,0,g.videoWidth,g.videoHeight);const n=await this.g_bd$(_,a.format,a.quality);return{snapshotUrl:n}}g_aLp(e){e.srcObject&&(this.g_bdU(e.srcObject),e.srcObject=null)}g_Jj(){if(!this.g_bdC)return;const g={},e={sequenceNumber:this.g_bdD++,videoData:g},_=[],a=[];for(const[t,n]of this.g_aZD.entries()){if(!n.srcObject)continue;const e={};a.push(createImageBitmap(n).then(g=>{e.imageBitmap=g,_.push(g)}).catch(()=>{e.imageBitmap=null})),g[t.toString()]=e}Promise.all(a).then(()=>this.g_aZo("state",e,!1,_))}};g_aZT.g_a_P(e)}{const e=class extends g_aZk{constructor(e){super(e,"game-recorder"),this.g_bea=null,this.g_beb=null,this.g_bec=!0,this.g_bed=[],this.g_bee="",this.g_aZv("get-supported-formats",()=>this.g_bef()),this.g_aZv("start-recording",e=>this.g_beg(e)),this.g_aZv("start-screen-recording",e=>this.g_beh(e)),this.g_aZv("start-user-media-recording",e=>this.g_bei(e)),this.g_aZv("stop-recording",()=>this.g_bej()),this.g_bek()}g_bek(){if(!(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)&&navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints&&navigator.mediaDevices.getUserMedia){const e=navigator.mediaDevices.getSupportedConstraints();e.mediaSource&&(navigator.mediaDevices.getDisplayMedia=function(){return navigator.mediaDevices.getUserMedia({video:{mediaSource:"screen"}})})}}g_bef(){const g=this.g_aov.g_a_l(),a="undefined"!=typeof MediaRecorder,_=!!(g.captureStream&&a),t=[],n=[];return _&&(MediaRecorder.isTypeSupported("video/webm;codecs=vp8")&&t.push("video/webm;codecs=vp8"),MediaRecorder.isTypeSupported("video/webm;codecs=vp9")&&t.push("video/webm;codecs=vp9"),MediaRecorder.isTypeSupported("audio/ogg;codecs=opus")&&n.push("audio/ogg;codecs=opus"),MediaRecorder.isTypeSupported("audio/webm;codecs=opus")&&n.push("audio/webm;codecs=opus")),{isSupported:_,isMediaRecorderSupported:a,isScreenRecordingSupported:!!(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia&&"undefined"!=typeof MediaRecorder),supportedVideoFormats:t,supportedAudioFormats:n}}g_bel(e){const g=e.getTracks();for(let _=0,a=g.length;_<a;++_){const e=g[_];"video"===e.kind&&e.stop()}}g_bem(){this.g_bej(),this.g_bed.length=0,this.g_bee&&(URL.revokeObjectURL(this.g_bee),this.g_bee="")}g_beg(_){const a=_.videoType,t=_.audioType,n=_.bitsPerSecond,d=_.framerate;this.g_bem();let e=[],i=[];try{if(a){const g=this.g_aov.g_a_l();let a;a=0<d?g.captureStream(d):g.captureStream(),e=a.getVideoTracks()}if(t&&self.C3Audio_GetOutputStream){const e=self.C3Audio_GetOutputStream();i=e.getAudioTracks()}this.g_beb=new MediaStream([...e,...i]),this.g_bec=!0,this.g_bea=new MediaRecorder(this.g_beb,{mimeType:a||t,bitsPerSecond:n})}catch(e){console.error("[Game Recorder] Failed to start recording: ",e),this.g_aZo("error")}this.g_ben(a,t)}async g_beh(g){const a=g.videoType,_=g.audioType,t=g.bitsPerSecond;this.g_bem();let n=[],d=[];try{if(a){const e=await navigator.mediaDevices.getDisplayMedia({video:!0});n=e.getVideoTracks()}if(_&&self.C3Audio_GetOutputStream){const e=self.C3Audio_GetOutputStream();d=e.getAudioTracks()}this.g_beb=new MediaStream([...n,...d]),this.g_bec=!0,this.g_beb.addEventListener("inactive",()=>this.g_beo()),this.g_bea=new MediaRecorder(this.g_beb,{mimeType:a||_,bitsPerSecond:t})}catch(e){console.error("[Game Recorder] Failed to start recording: ",e),this.g_aZo("error")}this.g_ben(a,_)}async g_bei(e){const g=e.videoType,_=e.audioType,t=e.bitsPerSecond;if(this.g_bem(),!!self.C3UserMedia_GetLastMediaStream){const e=self.C3UserMedia_GetLastMediaStream();if(e){try{this.g_beb=e,this.g_bec=!1,this.g_bea=new MediaRecorder(this.g_beb,{mimeType:g||_,bitsPerSecond:t})}catch(e){console.error("[Game Recorder] Failed to start recording: ",e),this.g_aZo("error")}this.g_ben(g,_)}}}g_ben(e,g){this.g_bea.ondataavailable=e=>{this.g_bed.push(e.data)},this.g_bea.onerror=e=>{console.error("[Game Recorder] Error recording: ",e),this.g_aZo("error")},this.g_bea.onwarning=e=>{console.warn("[Game Recorder] Recording warning: ",e)},this.g_bea.onstop=()=>{const a=new Blob(this.g_bed,{type:e||g});this.g_bee=URL.createObjectURL(a),this.g_aZo("recording-ready",{url:this.g_bee})},this.g_bea.start()}g_beo(){this.g_aZo("screen-recording-stopped"),this.g_bej()}g_bej(){this.g_bea&&(this.g_bea.stop(),this.g_bea=null),this.g_beb&&(this.g_bec&&this.g_bel(this.g_beb),this.g_beb=null)}};g_aZT.g_a_P(e)}{function g(e){e.stopPropagation()}function a(e){13!==e.which&&27!==e.which&&e.stopPropagation()}const e=class extends g_aZC{constructor(e){super(e,"text-input"),this.g_aZM("scroll-to-bottom",e=>this.g_bep(e))}g_aci(_,t){let n;const d=t.type;return"textarea"===d?(n=document.createElement("textarea"),n.style.resize="none"):(n=document.createElement("input"),n.type=d),n.style.position="absolute",n.autocomplete="off",n.addEventListener("touchstart",g),n.addEventListener("touchmove",g),n.addEventListener("touchend",g),n.addEventListener("mousedown",g),n.addEventListener("mouseup",g),n.addEventListener("keydown",a),n.addEventListener("keyup",a),n.addEventListener("click",e=>{e.stopPropagation(),this.g_aZP("click",_)}),n.addEventListener("dblclick",e=>{e.stopPropagation(),this.g_aZP("dblclick",_)}),n.addEventListener("input",()=>this.g_aZO("change",_,{text:n.value})),n.id=t.id,this.g_aZQ(n,t),n}g_aZQ(e,g){e.value=g.text,e.placeholder=g.placeholder,e.title=g.title,e.disabled=!g.isEnabled,e.readOnly=g.isReadOnly,e.spellcheck=g.spellCheck}g_bep(e){e.scrollTop=e.scrollHeight}};g_aZT.g_a_P(e)}{function _(e){e.stopPropagation()}const e=class extends g_aZC{constructor(e){super(e,"list"),this.g_aZM("set-selected-index",(e,g)=>this.g_beq(e,g.selectedIndex)),this.g_aZM("add-item",(e,g)=>this.g_ber(e,g)),this.g_aZM("remove-item",(e,g)=>this.g_bes(e,g)),this.g_aZM("set-item",(e,g)=>this.g_bet(e,g)),this.g_aZM("clear",e=>this.g_beu(e)),this.g_aZM("load-state",(e,g)=>this.g_baO(e,g))}g_aci(t,a){const n=a.isDropdown,d=a.isMultiSelect,e=a.items,i=document.createElement("select");i.style.position="absolute",i.style.userSelect="none",i.style.webkitUserSelect="none",i.multiple=d,n||(i.size=2);for(const g of e)i.add(this.g_bev(g));return i.addEventListener("touchstart",_),i.addEventListener("touchmove",_),i.addEventListener("touchend",_),i.addEventListener("mousedown",_),i.addEventListener("mouseup",_),i.addEventListener("click",e=>{e.stopPropagation(),this.g_aZP("click",t,this.g_bew(i))}),i.addEventListener("dblclick",e=>{e.stopPropagation(),this.g_aZP("dblclick",t,this.g_bew(i))}),i.addEventListener("change",()=>this.g_aZO("change",t,this.g_bew(i))),i.id=a.id,this.g_aZQ(i,a),i}g_bev(e){const g=document.createElement("option");return g.text=e,g}g_bew(e){const g=e.selectedIndex,a=[];for(let g=0,_=e.length;g<_;++g)e.options[g].selected&&a.push(g);return{selectedIndex:g,selectedIndices:a}}g_aZQ(e,g){e.title=g.title,e.disabled=!g.isEnabled,e.multiple=!!g.isMultiSelect}g_beq(e,g){e.selectedIndex=g}g_ber(g,a){const _=a.text,t=a.index,n=this.g_bev(_);0>t?g.add(n):g.add(n,t)}g_bes(e,g){e.remove(g.index)}g_bet(e,g){e.options[g.index].text=g.text}g_beu(e){e.innerHTML=""}g_baO(e,g){e.innerHTML="";for(const a of g.items)e.add(this.g_bev(a));e.selectedIndex=g.selectedIndex;for(const a of g.selectedIndices){const g=e.options[a];g&&(g.selected=!0)}}};g_aZT.g_a_P(e)}{function g(e){e.stopPropagation()}const e=class extends g_aZC{constructor(e){super(e,"button")}g_aci(a,_){const t=document.createElement("input"),n=_.isCheckbox;let e=t;if(n){t.type="checkbox";const g=document.createElement("label");g.appendChild(t),g.appendChild(document.createTextNode("")),g.style.fontFamily="sans-serif",g.style.userSelect="none",g.style.webkitUserSelect="none",g.style.display="inline-block",g.style.color="black",e=g}else t.type="button";return e.style.position="absolute",e.addEventListener("touchstart",g),e.addEventListener("touchmove",g),e.addEventListener("touchend",g),e.addEventListener("mousedown",g),e.addEventListener("mouseup",g),e.addEventListener("keydown",g),e.addEventListener("keyup",g),t.addEventListener("click",()=>this.g_aZP("click",a,{isChecked:t.checked})),t.id=_.id,this.g_aZQ(e,_),e}g_bex(e){return"input"===e.tagName.toLowerCase()?e:e.firstChild}g_aZQ(e,g){const a=this.g_bex(e);a.checked=g.isChecked,a.disabled=!g.isEnabled,e.title=g.title,e===a?a.value=g.text:e.lastChild.textContent=g.text}};g_aZT.g_a_P(e)}